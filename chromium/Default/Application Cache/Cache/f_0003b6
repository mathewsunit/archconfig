lw.prototype.d8=NO(59,function(){return bv(this,3)});jD.prototype.d8=NO(58,function(){return bv(this,5)});lw.prototype.G5=NO(57,function(){return U(this,3)});jD.prototype.G5=NO(56,function(){return U(this,5)});lw.prototype.f8=NO(55,function(){return bv(this,2)});jD.prototype.f8=NO(54,function(){return bv(this,4)});lw.prototype.T5=NO(53,function(){return U(this,2)});jD.prototype.T5=NO(52,function(){return U(this,4)});function EPd(a,b){$f(a,11,b)}function FPd(a,b,c){return"r"==c?Slb(a,b):Tlb(a,b)}
function GPd(a,b){return(a=JR(a,b))?a.rect:null}function HPd(a,b){a.D=b}function IPd(a,b,c){c=void 0===c?!0:c;cq.call(this,"docs-material-dialog",a,b);oq(this,null);nq(this,!0);jq(this,this.IJ?0:.6);this.O=new OR("OK");this.Ga(this.O);(this.C=c?new NR("Cancel"):null)&&this.Ga(this.C)}q(IPd,cq);p=IPd.prototype;
p.Ia=function(){var a=this;cq.prototype.Ia.call(this);this.getHandler().R(this.O,"action",function(){return a.A7()}).R(this.Pa(),"keypress",this.CIb);this.C&&this.getHandler().R(this.C,"action",function(){a.dispatchEvent("Ac")&&a.setVisible(!1)})};p.CIb=function(a){13==a.keyCode&&(a.target==VCa(this)||this.C&&a.target==this.C.getElement()?this.dispatchEvent("Ac")&&this.setVisible(!1):("TEXTAREA"!=a.target.tagName&&"SELECT"!=a.target.tagName&&"A"!=a.target.tagName||a.target.disabled)&&this.A7())};
p.A7=function(){this.dispatchEvent("zc")&&this.setVisible(!1)};p.Ca=function(){cq.prototype.Ca.call(this);var a=hq(this);this.C&&this.C.render(a);this.O.render(a);L(a,!0);Fq(VCa(this),kBc)};p.ez=function(a){cq.prototype.ez.call(this,a);jq(this,this.IJ?0:.6)};function JPd(a){Vf(this,a,0,-1,null,null)}x(JPd,Uf);function KPd(a){Vf(this,a,0,-1,null,null)}x(KPd,Uf);var LPd=/['()]/g;function MPd(a){return"%"+a.charCodeAt(0).toString(16)}
function NPd(a){a=Pb(String(a));LPd.lastIndex=0;return LPd.test(a)?a.replace(LPd,MPd):a}function OPd(a){return a.ll()+Zb(a.C)}
function PPd(a){var b=P;var c=Sq(""+O(a.V1b));c='<div class="docs-unsupportedofficefeatureswarning-content-header"><div class="docs-unsupportedofficefeatureswarning-content-header-warningtext">'+O(c)+'</div><div class="docs-unsupportedofficefeatureswarning-content-header-restorefiletext">';c=P(c+"The original file can be restored from version history</div></div>");var d='<div class="docs-unsupportedofficefeatureswarning-content-features-list">';a=a.hd;for(var e=a.length,f=0;f<e;f++)d+=P('<div class="docs-unsupportedofficefeatureswarning-content-feature">'+
O({feature:Rq(""+a[f])}.feature)+"</div>");d=P(d+"</div>");return b(c+d)};function F2(a,b,c,d){et.call(this,"docs-unsupportedofficefeatureswarning",void 0,d);this.xa=b;this.Da=c;this.J=new OR(this.ACa());this.Ga(this.J);this.C=null;this.b8()&&(this.C=new OR(this.NCa()),this.Ga(this.C));this.F=null;a.F&&I(H(),"docs-esdttfl")&&(this.F=new LP("warning-dialogs",!1,d),this.Ga(this.F));oq(this,null);nq(this,!1);this.ez(!1);this.Ai=!0}x(F2,et);p=F2.prototype;p.fka=n("alertdialog");
p.Ca=function(){F2.oa.Ca.call(this);Fq(this.Lb(),PPd,{hd:this.xa,V1b:this.Da},void 0);var a=hq(this);this.F&&this.F.render(a);this.J.render(a);this.b8()&&this.C.render(a);L(a,!0);L(gq(this),!1);zq(this,null);Nh(this.Pa(),this.Nza())};p.Ia=function(){var a=this;F2.oa.Ia.call(this);this.getHandler().R(this.J,"action",function(){return a.ala()});this.b8()&&this.getHandler().R(this.C,"action",function(){a.setVisible(!1)})};p.ala=function(){this.setVisible(!1)};p.b8=Oe;p.NCa=sa;function QPd(a,b,c,d,e,f){F2.call(this,a,b,c,d);this.L=!1;this.ma=e;this.O=f}x(QPd,F2);p=QPd.prototype;p.Nza=n("docs-editconsentdialog");p.ACa=n("Continue editing");p.b8=Pe;p.NCa=n("Cancel");p.ala=function(){QPd.oa.ala.call(this);this.L=!0;this.ma.Xb()};p.$l=function(){QPd.oa.$l.call(this);this.L||this.O.Xb()};function RPd(a,b,c,d){F2.call(this,a,b,c,d)}x(RPd,F2);RPd.prototype.Nza=n("docs-unsupportedfeatureslistdialog");RPd.prototype.ACa=n("OK");function SPd(a){return P('<input type="text" id="docs-copy-link" class="'+Q("docs-copy-link")+'" value="'+Q(a.link)+'" readonly="readonly">')};function G2(a,b,c,d){et.call(this,void 0,void 0,a);this.J=this.O=this.L=this.C=null;this.Da="";this.F=b||null;this.xa=c||new Ayb(a);this.ma=null!=d?d:null;a=new lq;qq(a,{key:"done",caption:"Done"},!0,!0);this.F&&this.xa.C()&&qq(a,{key:"copy-link",caption:"Copy link"});oq(this,a)}x(G2,et);p=G2.prototype;
p.Ca=function(){G2.oa.Ca.call(this);Nh(iq(this),"copy-link-dialog");Nh(pq(this.D,"done"),"copy-link-done-button");this.C=N(SPd,{link:this.Da},void 0,this.qa());Gh(this.C,"label","Link to this comment");this.Lb().appendChild(this.C);if(this.L=pq(this.D,"copy-link")){var a=ce("DIV");Nh(a,"copy-link-butter-holder");this.getElement().insertBefore(a,gq(this));this.O=new hp(a);this.J=jp("Link copied to clipboard.","info",!1,4E3)}null!==this.ma&&(ci(this.Rq(),"z-index",this.ma),ci(iq(this),"z-index",this.ma+
1))};p.Bl=function(){G2.oa.Bl.call(this);this.F&&this.getHandler().R(this.F,"copy",this.tAa);this.C.focus();this.C.select()};p.$l=function(){G2.oa.$l.call(this);this.F&&this.getHandler().Gc(this.F,"copy",this.tAa)};p.Ia=function(){G2.oa.Ia.call(this);this.getHandler().R(this.C,"click",this.hSb);this.L&&this.getHandler().R(this.L,"click",this.Nmb)};p.QSb=function(a){this.Da=a;this.C&&(this.C.value=a)};p.hSb=function(a){a.target.focus();a.target.select()};
p.Nmb=function(a){a.stopPropagation();this.F&&this.xa.C()&&this.C&&this.C.value&&(this.C.focus(),this.C.select(),this.F.C(this.C.value))};p.tAa=function(a){a.C&&this.J&&this.O&&(this.J.isVisible()||this.O.postMessage(this.J),this.C.focus(),this.C.select())};p.Ha=function(){G2.oa.Ha.call(this);C(this.J);delete this.J;delete this.L;delete this.C};function TPd(a){var b=a.description;a=a.qQb;return P('<div class="waffle-dv-rec-chip" title="'+Q(b)+'"><div class="waffle-dv-rec-range">'+O(a)+'</div><div class="waffle-dv-rec-description">'+O(b)+"</div></div>")}function UPd(){return P('<div class="waffle-dv-no-suggestions" role="alert" aria-live="polite">No suggestions for selected data</div>')};function H2(){var a=new dM(null);QO(a,!0);return a};function VPd(a,b,c){E.call(this);this.D=a;this.Qf=b;this.Tb=c;this.V=this.H=this.Fa=this.Da=this.$=this.F=null;this.hc=new xP;this.Aa(this.hc);this.le=new xP;this.Aa(this.le);this.xa=this.O=null;this.Ad=new xP;this.Aa(this.Ad);this.Ke=new xP;this.Aa(this.Ke);this.Ra=this.Ma=this.Na=this.ma=this.L=null;this.Id=new xP;this.Aa(this.Id);this.Yd=new xP;this.Aa(this.Yd);this.bd=new xP;this.Aa(this.bd);this.Ie=new xP;this.Aa(this.Ie);this.Ua=this.Sc=null;this.C=new zT("");this.Aa(this.C);this.mb=this.J=
this.Eb=this.zb=this.Se=this.Hc=this.Pb=this.yb=null;this.Mg=this.fd=!1;this.Jb=this.Ff=this.Sa=this.sb=null;this.jf=new Uh(this);this.Aa(this.jf);this.Wc=new jv;this.qg=this.dh=this.Ng=this.Zf=this.Og=this.Ka=null;this.wx();a=this.jf;a.R(this.F,"action",this.rsb);a.R(this.$,"action",this.Kla);a.R(this.Da,"action",this.Kla);a.R(this.Fa,"action",this.Kla);a.R(this.J,"focus",Ca(this.SQa,!0));a.R(this.J,"blur",Ca(this.SQa,!1));a.R(this.J,"change",this.yla);a.R(this.J,"keyup",this.yla);b=[this.O,this.xa,
this.H,this.V,this.L,this.ma,this.Ma,this.Ra];for(c=0;c<b.length;c++)this.jf.R(b[c],"change",v(this.DYb,this,b[c])),this.jf.R(b[c],"keyup",v(this.msb,this,b[c]));a.R(this.Sa,"change",v(this.GIa,this));a.R(this.Na,"change",v(this.hEb,this));a.jg(this.mb,of,this.xzb)}x(VPd,E);var WPd="placeholder"in document.createElement("input"),XPd=/\s*,\s*/;
function YPd(a){var b=a.qg;b||(b=[{Ui:"List from a range",type:4},{Ui:"List of items",type:3},{Ui:"Number",type:0},{Ui:"Text",type:1},{Ui:"Date",type:2},{Ui:"Custom formula is",type:5}],I(H(),"fecdv")&&b.push({Ui:"Tick box",type:6}),a.qg=b);return b}
function ZPd(a){var b=a.dh;b||(b=[{Ui:"contains",code:9,inputs:0,example:"Approved"},{Ui:"does not contain",code:10,inputs:0,example:"Approved"},{Ui:"equals",code:13,inputs:0,example:"Approved"},{Ui:"is a valid email",code:14,inputs:-1,example:null},{Ui:"is a valid URL",code:15,inputs:-1,example:null}],a.dh=b);return b}
function $Pd(a){var b=a.Zf;b||(b=[{Ui:"is a valid date",code:30,inputs:-1,example:null},{Ui:"equal to",code:16,inputs:2,example:"15/11/2014"},{Ui:"before",code:17,inputs:2,example:"15/11/2014"},{Ui:"on or before",code:19,inputs:2,example:"15/11/2014"},{Ui:"after",code:18,inputs:2,example:"15/11/2014"},{Ui:"on or after",code:20,inputs:2,example:"15/11/2014"},{Ui:"between",code:21,inputs:3,example:"15/11/2014",zP:"15/11/2015"},{Ui:"not between",code:22,inputs:3,example:"15/11/2014",zP:"15/11/2015"}],
a.Zf=b);return b}function aQd(a){var b=a.Ng;b||(b=[{Ui:"range",code:23,inputs:6,example:null},{Ui:"the list of items",code:24,inputs:5,example:"Enter items separated by a comma..."}],a.Ng=b);return b}
function bQd(a){var b=a.Og;b||(b=[{Ui:"between",code:7,inputs:8,example:"10",zP:"100"},{Ui:"not between",code:8,inputs:8,example:"10",zP:"100"},{Ui:"less than",code:3,inputs:7,example:"10"},{Ui:"less than or equal to",code:4,inputs:7,example:"10"},{Ui:"greater than",code:1,inputs:7,example:"10"},{Ui:"greater than or equal to",code:2,inputs:7,example:"10"},{Ui:"equal to",code:5,inputs:7,example:"10"},{Ui:"not equal to",code:6,inputs:7,example:"10"}],a.Og=b);return b}
function cQd(){return{Ui:"",code:29,inputs:0,example:"=ISODD(A1)"}}function dQd(){return{Ui:"",code:31,inputs:-1,example:""}}p=VPd.prototype;
p.wx=function(){var a=this.D,b,c,d,e,f,h,k,l,m,r,u,w,y,B,J=a.qa(),R;var X=J.Ca("TR","waffle-dv-trrules",J.Ca("TD","waffle-dv-label",J.Ca("SPAN",{id:"waffle-dv-criteria"},"Criteria:")),J.Ca("TD",{colspan:"7"},l=J.Ca("DIV","goog-inline-block"),R=J.Ca("DIV","goog-inline-block"),h=J.Ca("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),c=J.Ca("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),e=J.Ca("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"}),
b=J.Ca("SPAN","waffle-dv-separator","and"),k=J.Ca("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),d=J.Ca("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),f=J.Ca("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"})));this.bd.gb(h);this.Ie.gb(k);this.Ad.gb(c);this.Ke.gb(d);this.hc.gb(e);this.le.gb(f);var Y=H2();Mi(Y,l);var la=H2();Mi(la,l);var qa=H2();Mi(qa,l);var za=H2();Mi(za,l);var Ea=eQd(a,R);(w=Y.getElement())&&Gh(w,"labelledby","waffle-dv-criteria");
var La;var Ja=J.Ca("TR","waffle-dv-trrules waffle-dv-trrules-showitems",J.Ca("TD"),J.Ca("TD",{colspan:"7"},La=J.Ca("SPAN","waffle-dv-label waffle-dv-checkbox-label","Show drop-down list in cell")));w=new jt;ht(w,La);Mi(w,La);var ab=J.Ca("TR","waffle-dv-trrules waffle-dv-trrules-showitems",J.Ca("TD"),J.Ca("TD",{colspan:"7"},m=J.Ca("SPAN","waffle-dv-label waffle-dv-checkbox-label","Use custom cell values")));var Eb=new jt;ht(Eb,m);Mi(Eb,m);var pb=J.Ca("TR","waffle-dv-trrules",J.Ca("TD"),J.Ca("TD","waffle-dv-customcheckboxlabel",
J.Ca("SPAN",{id:"customCheckboxInputLabel_checked"},"Ticked:")),J.Ca("TD",{colspan:"6","class":"waffle-dv-show-dropdown"},r=J.Ca("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"})));var eb=J.Ca("TR","waffle-dv-trrules",J.Ca("TD"),J.Ca("TD","waffle-dv-customcheckboxlabel",J.Ca("SPAN",{id:"customCheckboxInputLabel_unchecked"},"Unticked:")),J.Ca("TD",{colspan:"6","class":"waffle-dv-show-dropdown"},u=J.Ca("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"})));this.Id.gb(r);
this.Yd.gb(u);Gh(r,"labelledby","customCheckboxInputLabel_checked");Gh(u,"labelledby","customCheckboxInputLabel_unchecked");AP(this.Id,"e.g. TRUE");AP(this.Yd,"e.g. FALSE");var Fc=J.Ca("TR","waffle-dv-trrules",J.Ca("TD","waffle-dv-label",J.Ca("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-on-invalid-data"},"On invalid data: ")),J.Ca("TD",{colspan:"7"},J.Ca("DIV",{role:"radiogroup","aria-labelledby":"waffle-dv-on-invalid-data"},J.Ca("INPUT",{type:"radio",id:"showWarningOnInvalidData_radio",name:"onInvalidData",
role:"radio"}),J.Ca("LABEL",{"for":"showWarningOnInvalidData_radio"},"Show warning"),J.Ca("INPUT",{type:"radio",id:"rejectInvalidData_radio",name:"onInvalidData",role:"radio"}),J.Ca("LABEL",{"for":"rejectInvalidData_radio"},"Reject input"))));m=new $Lc(!0);aMc(m,"onInvalidData",Fc);var ic=J.Ca("TR","waffle-dv-trrules waffle-dv-trrules-appearance",J.Ca("TD",null,J.Ca("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-appearance"},"Appearance:")),J.Ca("TD",{colspan:"7"},y=J.Ca("SPAN","waffle-dv-label waffle-dv-checkbox-label",
"Show validation help text:")));var Zc=new jt;ht(Zc,y);Mi(Zc,y);y=Zc.Pa();var Uc=Via(y,"labelledby");Gh(y,"labelledby","waffle-dv-appearance "+Uc);y=J.Ca("TR","waffle-dv-trrules",J.Ca("TD"),J.Ca("TD",{colspan:"7","class":"waffle-dv-show-dropdown"},B=J.Ca("INPUT",{type:"text","class":"waffle-dv-helptext jfk-textinput"}),Uc=J.Ca("SPAN",{"class":"menuMainLink waffle-dv-smalltext","aria-label":"Reset help text to default value."},"Reset")));ze(Uc,!0);a=a.Da.childNodes[0];J.appendChild(a,X);J.appendChild(a,
Ja);J.appendChild(a,ab);J.appendChild(a,pb);J.appendChild(a,eb);J.appendChild(a,Fc);J.appendChild(a,ic);J.appendChild(a,y);this.C.render(l);J=this.C;J.goa=29;J.resize();J=this.C;J.bMa=200;J.resize();this.C.getElement().style.width="324px";WPd?this.C.getElement().placeholder="Enter items separated by a comma...":(J=this.C.getElement(),sj(J,"Enter items separated by a comma...","Enter items separated by a comma..."));if(J=this.C.getElement())Kh(J,"Enter items separated by a comma..."),Oh(J,["waffle-dv-list-options-textarea",
"jfk-textinput"]);this.J=B;Y.setVisible(!0);J=YPd(this);fQd(this,J,Y);J=bQd(this);fQd(this,J,za);J=ZPd(this);fQd(this,J,la);J=$Pd(this);fQd(this,J,qa);gQd(this,Y,za,la,qa,h,k,c,d,e,f,b,l,Ea,Ja,y,w,La,Uc,Zc,R,m,Eb,r,u,ab,pb,eb)};
function gQd(a,b,c,d,e,f,h,k,l,m,r,u,w,y,B,J,R,X,Y,la,qa,za,Ea,La,Ja,ab,Eb,pb){a.F=b;a.F.setVisible(!0);a.Da=c;a.$=e;a.Fa=d;a.Sc=u;a.L=f;a.ma=h;a.O=k;a.xa=l;a.H=m;a.V=r;a.Ua=w;a.Ka=y;a.yb=qa;a.Na=Ea;a.Ma=La;a.Ra=Ja;a.Se=ab;a.zb=Eb;a.Eb=pb;L(a.Se,!1);L(a.zb,!1);L(a.Eb,!1);la.wc(!1);a.Sa=la;a.Jb=za;hQd(a,!1);a.Pb=B;R.wc(!0);a.sb=R;a.Ff=X;a.Hc=J;L(a.Hc,!0);iQd(a);jQd(a);a.mb=Y;L(a.mb,!1)}
function kQd(a,b){L(a.Pb,23==b||24==b);a.Ff.innerText="Show drop-down list in cell";b=31==b;L(a.Se,b);var c=a.Na.isChecked();L(a.zb,b&&c);L(a.Eb,b&&c)}function lQd(a){gQd(a,a.F,a.Da,a.Fa,a.$,a.L,a.ma,a.O,a.xa,a.H,a.V,a.Sc,a.Ua,a.Ka,a.Pb,a.Hc,a.sb,a.Ff,a.mb,a.Sa,a.yb,a.Jb,a.Na,a.Ma,a.Ra,a.Se,a.zb,a.Eb)}function fQd(a,b,c){for(var d=0;d<b.length;d++){var e=a.D.qa();e=new Nk(b[d].Ui,null,e);c.ud(e);Fh(e.getElement(),"menuitem")}c.Te(0)}p.Kla=function(){jQd(this);this.J.value=mQd(this);this.dispatchEvent("change")};
p.rsb=function(){iQd(this);jQd(this);this.J.value=mQd(this);this.dispatchEvent("change")};p.SQa=ca("Mg");p.yla=function(a){this.fd||a&&!rla(a)||this.J.value===nQd(this)||(this.fd=!0,L(this.mb,!0))};p.xzb=function(){this.fd=!1;this.J.value=mQd(this);L(this.mb,!1)};p.GIa=function(){L(this.Hc,this.Sa.isChecked())};p.hEb=function(){var a=this.Na.isChecked();a||oQd(this);L(this.zb,a);L(this.Eb,a);pQd(this)};function pQd(a){a.J.value=mQd(a)}function qQd(a){pQd(a);a.C.resize()}
p.DYb=function(a){pQd(this);rQd(this,a)?(this.D.bl=0,I2(a),this.dispatchEvent("change")):(this.D.bl=1,J2(a),this.dispatchEvent("error"))};p.msb=function(){this.dispatchEvent("keyup")};function rQd(a,b){if(0!=K2(a))return!0;var c=b.value;if(null!=c&&Bi(b)){if(!L2(a.D))return!0;a=M2(a,c,sQd(a).code);return null!=a&&(bv(a,3)||bv(a,5)&&a.Ao().yd()&&3==U(a.Ao().getValue(),1))}return!0}function J2(a){a.select();Nh(a,"waffle-input-error")}function I2(a){a&&Ph(a,"waffle-input-error")}
function oQd(a){I2(a.C.getElement());I2(a.H);I2(a.V);I2(a.L);I2(a.ma);I2(a.Ma);I2(a.O);I2(a.xa);I2(a.Ka.wr());a.D.bl=0;a.dispatchEvent("change")}function K2(a){return YPd(a)[a.F.Jg()].type}function iQd(a){var b=K2(a),c=!1,d=!1,e=!1,f=!1,h=!1;0==b?d=!0:2==b?c=!0:1==b?e=!0:3==b?f=!0:4==b&&(h=!0);a.$.setVisible(c);a.Da.setVisible(d);a.Fa.setVisible(e);L(a.Ua,f);L(a.yb,h);L(a.L,!1);L(a.ma,!1);L(a.O,!1);L(a.xa,!1);L(a.H,!1);L(a.V,!1);f&&a.C.resize();a.dispatchEvent("change")}
function sQd(a){var b;null!=tQd(a)?b=tQd(a):a.$.isVisible()?b=$Pd(a)[a.$.Jg()]:a.Da.isVisible()?b=bQd(a)[a.Da.Jg()]:5==K2(a)?b=cQd():6==K2(a)?b=dQd():b=ZPd(a)[a.Fa.Jg()];return b}function tQd(a){var b=aQd(a);return 4==K2(a)?b[0]:3==K2(a)?b[1]:null}
function jQd(a){var b=!1,c=!1,d=!1,e=!1,f=!1,h=!1,k=!1,l=!1,m=!1,r=sQd(a);-1!=r.inputs&&(0==r.inputs?d=!0:1==r.inputs?k=e=d=!0:2==r.inputs?f=!0:3==r.inputs?k=h=f=!0:7==r.inputs?b=!0:8==r.inputs?k=c=b=!0:5==r.inputs?l=!0:6==r.inputs&&(m=!0));var u=sQd(a);if(3==K2(a))WPd?a.C.getElement().placeholder="Enter items separated by a comma...":(u=a.C.getElement(),sj(u,"Enter items separated by a comma...","Enter items separated by a comma..."));else if(u.example)if(0==u.inputs||1==u.inputs)AP(a.Ad,"e.g. "+
u.example),AP(a.Ke,"e.g. "+u.zP||"");else if(2==u.inputs||3==u.inputs)AP(a.hc,"e.g. "+u.example),AP(a.le,"e.g. "+u.zP||"");else if(7==u.inputs||8==u.inputs)AP(a.bd,"e.g. "+u.example),AP(a.Ie,"e.g. "+u.zP||"");oQd(a);L(a.L,b);L(a.ma,c);L(a.O,d);L(a.xa,e);L(a.H,f);L(a.V,h);L(a.Ua,l);l&&a.C.resize();L(a.yb,m);kQd(a,r.code);L(a.Sc,k)}
function M2(a,b,c){var d=L2(a.D);if(""==b||null==d.C)return null;var e=d.rect,f=e.xc();e=e.rc();return(b=ritz_api.RitzModelApi.parseConditionArgument(d.C,f,e,b,c,!0))?a.Wc.xd(Jv.Ba(),b):null}
function uQd(a){var b=new Ov,c=sQd(a),d=c.code,e=[];switch(c.inputs){case 0:e.push(M2(a,a.O.value,d));break;case 1:e.push(M2(a,a.O.value,d));e.push(M2(a,a.xa.value,d));break;case 2:e.push(M2(a,a.H.value,d));break;case 3:e.push(M2(a,a.H.value,d));e.push(M2(a,a.V.value,d));break;case 7:e.push(M2(a,a.L.value,d));break;case 8:e.push(M2(a,a.L.value,d));e.push(M2(a,a.ma.value,d));break;case 5:a=a.C.getValue().split(",");for(c=0;c<a.length;c++)e.push(RCc(a[c]));break;case 6:c=pnb("="+a.Ka.getValue());e.push(M2(a,
c,d));break;case -1:a.Na.isChecked()&&(e.push(M2(a,Ob(a.Ma.value),d)),Kb(a.Ra.value)||e.push(M2(a,Ob(a.Ra.value),d)))}for(a=0;a<e.length;a++)if(!e[a])return null;d=kS(d,e);V(b,1,d);return b}function vQd(a){var b=Ob(a.Ka.getValue());!a.Tb.D.D[Ob(Zb(b).toLowerCase())]&&IR(a.Tb,b)&&(b=$Ac(a.Tb,b,!0));return b}function mQd(a){return a.fd||a.Mg?a.J.value:nQd(a)}
function nQd(a){var b="";var c=K2(a);var d=4==c;c=3==c||4==c;if(a.$.isVisible())c=$Pd(a)[a.$.Jg()],b=-1==c.inputs?b+"Enter a valid date":b+"Enter a date ";else if(a.Fa.isVisible())c=ZPd(a)[a.Fa.Jg()],b=14==c.code?b+"Enter a valid email":15==c.code?b+"Enter a valid URL":b+"Enter text that ";else if(c)c=tQd(a),b+="Click and enter a value from ";else if(5==K2(a))c=cQd(),b="Enter a value that satisfies the formula:";else if(6==K2(a))if(c=dQd(),a.Na.isChecked()&&!Kb(Ob(a.Ma.value))){b=Ob(a.Ma.value);var e=
Ob(a.Ra.value);b=Kb(e)?"Enter "+(b+" or blank."):"Enter "+(b+(" or "+(e+".")))}else b="Enter TRUE or FALSE.";else c=bQd(a)[a.Da.Jg()],b+="Enter a number ";-1!=c.inputs&&(b+=c.Ui);e=vQd(a);23==c.code&&""!=e&&d&&(d=$Ac(a.Tb,e,!0))&&(b+=" "+d);Kb(Zb(a.O.value))||0!=c.inputs&&1!=c.inputs?Kb(Zb(a.H.value))||2!=c.inputs&&3!=c.inputs?Kb(Zb(a.L.value))||7!=c.inputs&&8!=c.inputs||(b+=" "+a.L.value):b+=" "+a.H.value:b+=" "+a.O.value;Kb(Zb(a.xa.value))||1!=c.inputs?Kb(Zb(a.V.value))||3!=c.inputs?Kb(Zb(a.ma.value))||
8!=c.inputs||(b+=" and "+a.ma.value):b+=" and "+a.V.value:b+=" and "+a.xa.value;return b}function hQd(a,b){bMc(a.Jb,b?"rejectInvalidData_radio":"showWarningOnInvalidData_radio")}function N2(a,b){switch(b){case 0:a.F.Te(2);break;case 1:a.F.Te(3);break;case 2:a.F.Te(4);break;case 3:a.F.Te(1);break;case 4:a.F.Te(0);break;case 5:a.F.Te(5);break;case 6:a.F.Te(6)}}
function wQd(a,b,c,d,e){a.F.Te(0);a.$.Te(0);a.Da.Te(0);a.Fa.Te(0);a.J.value="";a.L.value="";a.ma.value="";a.H.value="";a.V.value="";a.O.value="";a.xa.value="";a.C.Qa("");a.Ka.Qa("");hQd(a,!1);var f=a.fd=!1,h=!1,k=!1,l=!1,m=!1,r=!1,u=!1,w=!1,y=!1,B=!1,J=!1,R=!1,X=!1,Y=!1,la=!1,qa=!1,za=!1,Ea=!1,La=b&&Pv(b);b=La&&Lv(La);if((La=La&&Mv(La))&&b){for(var Ja=aQd(a),ab=$Pd(a),Eb=bQd(a),pb=ZPd(a),eb=cQd(),Fc=dQd(),ic=0,Zc=0;Zc<Ja.length;Zc++)if(b==Ja[Zc].code){ic=Ja[Zc].inputs;23==Ja[Zc].code?(qa=!0,N2(a,
4)):(R=!0,N2(a,3));a.sb.wc(!!e);break}for(e=0;e<ab.length;e++)if(b==ab[e].code){ic=ab[e].inputs;a.$.Te(e);N2(a,2);X=w=!0;break}for(e=0;e<Eb.length;e++)if(b==Eb[e].code){ic=Eb[e].inputs;a.Da.Te(e);N2(a,0);Y=y=!0;break}for(e=0;e<pb.length;e++)if(b==pb[e].code){ic=pb[e].inputs;a.Fa.Te(e);N2(a,1);la=B=!0;break}b==eb.code&&(ic=eb.inputs,N2(a,5),za=!0);b==Fc.code&&(ic=Fc.inputs,N2(a,6),Ea=!0);if(X||la||Y||R||qa||za||Ea)if(la=L2(a.D),X=la.rect.xc(),Y=la.rect.rc(),la=la.C,-1==ic)Ea&&0<La.length&&(J=!0,a.Na.wc(!0),
a.Id.Qa(JE(La[0],la,X,Y)),1<La.length&&a.Yd.Qa(JE(La[1],la,X,Y)));else if(0==ic)m=JE(La[0],la,X,Y),a.Ad.Qa(m),m=!0;else if(1==ic)r=JE(La[0],la,X,Y),m=JE(La[1],la,X,Y),a.Ad.Qa(r),a.Ke.Qa(m),r=m=u=!0;else if(2==ic)f=JE(La[0],la,X,Y),a.hc.Qa(f),f=!0;else if(3==ic)h=JE(La[0],la,X,Y),f=JE(La[1],la,X,Y),a.hc.Qa(h),a.le.Qa(f),h=f=u=!0;else if(7==ic)k=JE(La[0],la,X,Y),a.bd.Qa(k),k=!0;else if(8==ic)l=JE(La[0],la,X,Y),k=JE(La[1],la,X,Y),a.bd.Qa(l),a.Ie.Qa(k),l=k=u=!0;else if(5==ic){R=!0;Ea=[];for(ic=0;ic<La.length;ic++)Ea.push(JE(La[ic],
la,X,Y));a.C.Qa(Ea.join(","));a.C.resize()}else 6==ic&&(qa=!0,Ea=JE(La[0],la,X,Y),null!=Ea&&(Ea=Ea.substring(1),La=!!cG(Ea),Ea=(ic=eG(Ea,a.Qf,!1,!0))?gG(ic.rect,VF(a.Qf,ic.C).$d()):Ea,La||(Ea=dG(Ea)),a.Ka.Qa(Ea)));else a.F.Te(0),qa=!0;L(a.Sc,u);a.$.setVisible(w);a.Da.setVisible(y);a.Fa.setVisible(B);L(a.H,f);L(a.V,h);L(a.O,m);L(a.xa,r);L(a.L,k);L(a.ma,l);L(a.zb,J);L(a.Eb,J);L(a.Pb,!0);L(a.Ua,R);a.C.resize();L(a.yb,qa);null!=b&&kQd(a,b)}else{if(I(H(),"feadv")){w=aI(a.Qf);y=w.Nc();B=new Nm;for(J=y.xc();J<
y.Yc();J++)for(R=y.rc();R<y.ad();R++)qa=w.ah(J,R),""!=UE(qa)&&Om(B,UE(qa).split(XPd));B.isEmpty()?w=!1:(lQd(a),a.C.Qa(B.qd().join(",")),N2(a,3),iQd(a),w=!0)}else w=!1;w||lQd(a)}a.GIa();c=c||"";w=c.lastIndexOf("</strong>");-1!=w&&(c=Sb(Ob(c.substring(w+9))));a.Sa.wc(!!c);c&&(mQd(a)!=c&&a.yla(),a.J.value=c,L(a.Hc,!0));hQd(a,d)}
p.Ha=function(){this.Pb=this.sb=this.mb=this.J=this.Sc=this.Ra=this.Ma=this.ma=this.L=this.xa=this.O=this.V=this.H=null;C(this.Ka);this.Ka=null;C(this.sb);this.sb=null;C(this.Fa);this.Fa=null;C(this.Da);this.Da=null;C(this.$);this.$=null;C(this.F);this.F=null;C(this.Sa);this.Sa=null;C(this.Jb);this.Jb=null;VPd.oa.Ha.call(this)};function xQd(a,b,c,d,e,f,h){cq.call(this);this.Eb=a;this.Ke=b;this.sb=c;this.le=d;this.O=e;this.Sa=f;this.zb=h;this.ma=new M(this.qa());this.Ga(this.ma);this.Sc=new Mq("",new GT,this.qa());this.Ga(this.Sc);this.Ua=new M(this.qa());this.Ga(this.Ua);this.Na=new ET(!1,"#4285f4");this.Ga(this.Na);this.fd=new HT(c,yQd.Wca,yQd.Xca);this.Aa(this.fd);this.F=this.Da=null;this.bd=new Uh(this);this.Aa(this.bd);this.yb=this.xa=this.J=this.C=null;this.Ra=I(H(),"fedvs");this.mb=this.L=null;this.Jb=-1;this.hc=[];
this.Tb=[];this.Ad=-1;a=JD(this.sb).Nc();this.Ie=Cw(a.xc(),a.rc(),a.Yc(),a.ad());this.Pb=!1;this.Hc=new Uh(this);this.Aa(this.Hc);this.xa=new lq;this.xa.set("save","Save",!1);this.xa.set("clear","Remove validation",!1,!1);this.xa.set("cancel","Cancel",!1,!0);oq(this,this.xa);kq(this,!1);this.render();a=this.Lb();b=this.qa();c=yQd;dq(this,"Data validation");this.J||(d=b.Ca("DIV",{"class":c.rVa}),e=b.Ca("DIV",{"class":c.qVa},d),b.appendChild(a,e),this.J=new gp(e),this.J.setType("warning"),this.J.setContent(""),
this.J.render(d),owa(this.J,!0),this.J.setVisible(!1));this.Ra&&(e=b.Ca("DIV",c.M0a),f=b.Ca("DIV",{id:zQd.Kva},"Suggested validations"),d=b.Ca("DIV",c.L0a),h=b.Ca("DIV",c.Wta,"Send feedback"),b.appendChild(a,e),b.appendChild(e,h),b.appendChild(e,f),b.appendChild(a,d),this.Sc.gb(h),L(h,Bz),this.ma.gb(d),e=b.Ca("DIV",c.o0a),b.appendChild(d,e),this.Ua.gb(e),this.Na.render(e),FT(this.Na,!0));this.Da=b.Ca("TABLE",{cellSpacing:"0","class":c.zA},b.Ca("TBODY"));b.appendChild(a,this.Da);this.Ra&&Nh(this.Da,
c.T0a);a=this.Lb();a=Rd(a);b=a.Ca("TR",yQd.k1a);b.appendChild(a.Ca("TD","waffle-dv-label",a.Ca("LABEL",{id:"waffle-dv-cell-range"},"Cell range: ")));c=a.Ca("TD",{colspan:"7"});this.C=eQd(this,c);AQd(this);b.appendChild(c);a.appendChild(this.Da.childNodes[0],b);(a=this.C.wr())&&Gh(a,"labelledby","waffle-dv-cell-range");this.F=new VPd(this,this.Eb,this.O);zq(this,"save");BQd(this)}x(xQd,cq);
var yQd={qVa:"waffle-input-error-butter-container",rVa:"waffle-input-error-butter-wrap",Wta:"waffle-dv-feedback-link",Wca:"waffle-dv-highlight-styled-border",Xca:"waffle-dv-highlight-styled-rect",sua:"waffle-input-error",o0a:"waffle-dv-rec-spinner-container",Sda:"waffle-dv-rec-chip-selected",L0a:"waffle-dv-rec-wrapper",M0a:"waffle-dv-recs-title-bar",zA:"waffle-dv-table",T0a:"waffle-dv-table-with-suggestions",k1a:"waffle-dv-trrules"},zQd={Kva:"waffle-dv-recs-title"};p=xQd.prototype;p.bl=0;
function AQd(a){if(a.C){var b=a.Eb.getActiveGrid();b&&(b=gG(JD(a.sb).Nc(),b.$d(),!0),a.C.Qa(b))}}function BQd(a){a.bd.R(a,"dialogselect",a.CYb).R(a.F,"error",a.jsb).R(a.F,"change",a.BYb).R(a.C,"change",function(){a.F&&pQd(a.F);if(a.Ra){var b=L2(a);a.Pb||a.L&&b&&b.intersects(JR(a.O,a.mb))||CQd(a)}});a.Ra&&a.bd.R(a.Sa,"recommender-calc-ended",a.AYb).R(a.Sc,"action",function(){K.bt.Xb({source:"dataValidationDialogFeedback"})})}p.jsb=function(){DQd(this)};
p.BYb=function(){DQd(this);rq(this.xa,"save",!0)};function EQd(a){var b=a.qa();a=a.ma.Pa();var c=N(UPd);b.appendChild(a,c)}
p.AYb=function(a){var b=this;FT(this.Na,!1);L(this.Ua.Pa(),!1);a=a.C;if(0==a.length)EQd(this);else for(var c=this.qa(),d=this.ma.Pa(),e=0,f={Re:0};f.Re<a.length;f={cN:f.cN,tD:f.tD,e0:f.e0,Re:f.Re,bf:f.bf,nD:f.nD},f.Re++){var h=a[f.Re],k=U(h,13);if(3<=e||!k)break;e++;f.bf=DR(h);f.e0=gG(cx(f.bf));f.tD=U(k,3);this.hc.push(f.tD);this.Tb.push(f.e0);h="";switch(Lv(f.tD)){case 14:h="Is valid email";break;case 15:h="Is valid URL";break;case 30:h="Is valid date";break;case 24:h="List: "+Mv(f.tD).map(function(a){return U(a.Ao().getValue(),
2)}).join();break;case 1:h="Greater than "+U(Mv(f.tD)[0].Ao().getValue(),3);break;case 7:h=Mv(f.tD);h="Between "+(U(h[0].Ao().getValue(),3)+(" and "+U(h[1].Ao().getValue(),3)));break;case 5:h=Mv(f.tD);h="Equal to "+U(h[0].Ao().getValue(),3);break;default:Klc.C("Unrecognized data validation type.")}k=zQd;f.nD=N(TPd,{description:h,qQb:f.e0});f.cN=new cr("",c);f.cN.ef(8,!0);f.cN.gb(f.nD);Gh(f.nD,"describedby",k.Kva);this.ma.Ga(f.cN);c.appendChild(d,f.nD);this.Hc.R(f.cN,"action",function(a){return function(){FQd(b,
a.cN,a.tD,a.e0,a.Re)}}(f)).R(f.nD,"mouseenter",function(a){return function(){IT(b.fd,bx(a.bf))}}(f)).R(f.nD,"mouseleave",function(){JT(b.fd)}).R(f.nD,"focus",function(a){return function(){pi(a.nD,d)}}(f))}};function FQd(a,b,c,d,e){var f=yQd,h=Mh(b.Pa(),f.Sda);a.ma.kf(function(a){a.vk(f.Sda,!1);a.tc(!1)});b.vk(f.Sda,!h);b.tc(!h);a.Pb=!0;h?(a.show(!0),a.L=null,a.mb=null,a.Jb=-1):(b=new Ov,V(b,1,c),wQd(a.F,b,null,null,!0),qQd(a.F),a.C.Qa(d),a.L=c,a.mb=d,a.Jb=e);a.Pb=!1}
p.CYb=function(a){if("save"==a.key){if(!GQd(this)){a.preventDefault();return}}else if("clear"==a.key&&!HQd(this)){a.preventDefault();return}this.C&&this.C.Oa(!1)};function DQd(a){var b=IQd(a.bl);b&&a.J.setContent(b);a.J.setVisible(0!=a.bl);b=2==a.bl||4==a.bl;var c=yQd,d=a.qa().Bw(a.C.getElement());Rh(d,c.sua,b);b&&a.C.wr().select()}
function IQd(a){switch(a){case 1:return"Please enter a valid number or formula";case 2:return"Please enter a valid range";case 3:return"Please enter a valid range";case 4:return"The selected ranges cannot intersect";case 5:return"Please enter a valid list of items";case 6:return"Please enter valid text";case 7:return"Please enter a valid date";case 8:return"Please enter a valid ticked value.";case 9:return"Enter different values for ticked and unticked cell contents.";case 10:return"Formulas are not permitted as custom ticked/unticked values."}return null}
function JQd(a){var b=a.F,c=K2(b);if(0==c){c=b.L;var d=b.ma,e=rQd(b,c),f=rQd(b,d);e&&f?b.D.bl=0:(e||J2(c),f||J2(d),b.D.bl=1)}else if(1==c)c=b.O,d=b.xa,e=!Bi(c)||!Kb(Zb(c.value)),f=!Bi(d)||!Kb(Zb(d.value)),e&&f?b.D.bl=0:(e||J2(c),f||J2(d),b.D.bl=6);else if(2==c)c=b.H,d=b.V,e=!Bi(c)||!Kb(Zb(c.value)),f=!Bi(d)||!Kb(Zb(d.value)),e&&f?b.D.bl=0:(e||J2(c),f||J2(d),b.D.bl=7);else if(3==c||4==c)c=0,4==K2(b)?(d=vQd(b),IR(b.Tb,d)?(d=vQd(b),d=JR(b.Tb,d),e=L2(b.D),null!=d&&null!=e&&d.C==e.C&&d.rect.intersects(e.rect)&&
(c=4)):c=3):3==K2(b)&&b.C.getElement()&&Kb(Zb(b.C.getValue()))&&(c=5),d=c,c=0==d,b.D.bl=d,d=b.yb&&Bi(b.yb),b.Ua&&Bi(b.Ua)?(Rh(b.C.getElement(),"waffle-input-error",!c),b.C.getElement().select()):d&&(d=b.D.qa().Bw(b.Ka.getElement()),Rh(d,"waffle-input-error",!c),b.Ka.focus()),c?b.dispatchEvent("change"):b.dispatchEvent("error");else if(6==c){if(b.Na.isChecked()){c=b.Ma;e=b.Ra;d=Ob(Zb(c.value));e=Ob(Zb(e.value));f="true"==d.toLowerCase()&&"true"==e.toLowerCase()||"false"==d.toLowerCase()&&"false"==
e.toLowerCase();var h=gc(d)==gc(e);f=d==e||h||f;Kb(d)?(J2(c),b.D.bl=8):f?b.D.bl=9:sC(d)||sC(e)?b.D.bl=10:b.D.bl=0}}else b.D.bl=0;b=a.C.getValue();b=IR(a.O,b);2==a.bl&&b?a.bl=0:0!=a.bl||b||(a.bl=2);DQd(a);return 0!=a.bl}
function GQd(a){if(JQd(a))return!1;var b=a.F,c=b.Jb.isChecked("rejectInvalidData_radio"),d=mQd(b);b.Sa.isChecked()||(d="");var e=uQd(b);if(!e)return!1;var f=new Dx;V(f,1,e);V(f,2,d);V(f,3,c);FAc(f,Bi(b.Pb)&&b.sb.isChecked());b=KQd(a);if(!b)return!1;c=new Jg;e=Pv(e);d=a.L&&Lv(a.L)==Lv(e);var h=Mv(e);if(d){var k=LQd(a,GPd(a.O,a.mb)),l=MQd(a);k=dx(k,b);G(c,12,!l||!k);var m=new JPd;G(m,1,!k);G(m,2,!l);G(m,3,a.Jb);PO(c,17,Xfa[0],m)}else{for(var r=m=k=l=!1,u=!1,w=0;w<a.Tb.length;w++){var y=LQd(a,GPd(a.O,
a.Tb[w]));if(y){var B=dx(y,b);y=DZa(y,b);var J=a.hc[w],R=Lv(J)==Lv(e);J=Mv(J);J=yb(J,h,function(a,b){return a.equals(b)});u|=J;l|=B&&R&&J;k|=B;m|=B&&R;r|=y}}w=new KPd;G(w,1,l);G(w,2,k);G(w,3,m);G(w,4,r);G(w,5,u);PO(c,18,Xfa[0],w)}yAc(c,kJc(Lv(e)));l=ha(a.hc);for(k=l.next();!k.done;k=l.next())EPd(c,kJc(Lv(k.value)));l=Fa()-a.Ad;G(c,14,l);l=new Hg;cg(l,58,c);c=Sj(Tj(new Rj,l),1).build();a.zb.Wb(d?35578:35301,c);31==Lv(e)&&a.zb.Wb(0<h.length?35604:35603,c);a.le.C(new OJc(f,b));return!0}
function MQd(a){var b=uQd(a.F);if(!b||!a.L)return!1;b=Mv(Pv(b));a=Mv(a.L);return yb(a,b,function(a,b){return a.Ao().getValue().equals(b.Ao().getValue())})}
function HQd(a){var b=KQd(a);if(!b)return!1;try{if(!uQd(a.F))return a.zb.Wb(35300),!0;var c=Pv(uQd(a.F)),d=a.L&&Lv(a.L)==Lv(c),e=!1,f=new Jg;if(d){var h=Elb(JD(a.sb).fp().Jc(),GPd(a.O,a.C.getValue()));jk(h,function(a){XE(a)&&(e=!0);return e});if(!e){var k=new KPd;G(k,6,!0);PO(f,18,Xfa[0],k)}}var l=new Hg;cg(l,58,f);var m=Sj(Tj(new Rj,l),1).build();a.zb.Wb(35300,m);return!0}finally{a.le.C(new OJc(new Dx,b))}}function KQd(a){var b=GPd(a.O,a.C.getValue());return LQd(a,b)}
function LQd(a,b){var c=a.C.getValue();a=(a=JR(a.O,c))?a.C:null;return b&&null!=a?Zw(b,a):null}function L2(a){var b=a.C.getValue();return JR(a.O,b)}function eQd(a,b){var c=a.Eb.C.$d();a=new tT(a.sb,v(a.zYb,a),!1,"e.g. Sheet1!A2:D5",!0,c,a.qa());a.render(b);return a}p.setVisible=function(a){xQd.oa.setVisible.call(this,a);a&&this.yb&&(this.yb.focus(),this.yb=null)};p.zYb=function(a,b,c,d){this.yb=a.wr();this.Ke.Lba(this,a,b,c,!1,!0,d)};
p.show=function(a){var b="",c=!1,d=aI(this.Eb),e=XE(xF(d,DF(d)));d=null;var f=!1;e&&(e=e.Nx,d=U(e,1),b=U(e,2),c=U(e,3),f=U(e,4));wQd(this.F,d,b,c,f);(b=uQd(this.F))&&Pv(b);this.setVisible(!0);this.C&&this.C.Oa(!0);AQd(this);qQd(this.F);CQd(this,a);this.Ad=Fa()};
function CQd(a,b){a.Ra&&!b&&(QAc(a.Sa)?(FT(a.Na,!0),L(a.Ua.Pa(),!0),a.ma.Bd(!0),a.Hc.Oc(),LAc(a.Sa),b=L2(a),null==b||Jw(b.rect)||b.rect.equals(a.Ie)?CBc(a.Sa,!0,!1,[6]):BBc(a.Sa,!0,!1,!1,[6],[L2(a).rect])):(FT(a.Na,!1),L(a.Ua.Pa(),!1),EQd(a)))}p.Ha=function(){C(this.F);this.F=null;C(this.C);this.xa=this.Da=this.C=null;C(this.J);xQd.oa.Ha.call(this)};function NQd(a,b,c,d,e){cq.call(this);this.Sa=c;this.mb=d.C;this.Ra=d;this.Tb=e;this.Ua=null;this.Eb=d.$;dq(this,"Find and replace");kq(this,!1);c=this.Lb();d=Rd(c);this.C=d.Ca("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.C.value=a;this.Na=d.Ca("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.F=new dM(null);this.Aa(this.F);this.Hc=b;this.O=new tT(this.Sa,v(this.FYb,this),!1,"",!0);this.Aa(this.O);this.xa=null;this.ma=new jt;this.Aa(this.ma);this.Da=new jt;this.Aa(this.Da);
this.L=new jt;this.Aa(this.L);this.J=new jt;this.Aa(this.J);this.Pb=this.yb=this.zb=this.Jb=!1;this.sb=d.Ca("SPAN");NCc(this.sb);this.hc=new Qr(this.C);this.Aa(this.hc);a=OQd;d.Ca("LABEL",{"for":a.Zta},"Search");b=d.Ca("LABEL",{"for":a.Tua},"Match case");e=d.Ca("LABEL",{"for":a.Uua},"Match entire cell contents");var f=d.Ca("LABEL",{},"Also search within formulae"),h=d.Ca("LABEL",{"for":a.wva},"Search using regular expressions "),k=(new Fl(j4a)).toString(),l=d.Ca("SPAN",null,d.Ca("A",{target:"_blank",
href:k},"Help"));this.getHandler().R(l,["keydown","keypress"],function(a){13==a.keyCode&&a.stopPropagation()});k=Ni(this,"findLabel");var m=Ni(this,"replaceLabel"),r=Ni(this,"findScopeLabel"),u=d.Ca("DIV","goog-inline-block"),w=d.Ca("DIV",a.J_a);l=d.Ca("TABLE",null,d.Ca("TBODY",null,d.Ca("TR",null,d.Ca("TD",a.LABEL,d.Ca("LABEL",{id:k},"Find")),d.Ca("TD",null,this.C)),d.Ca("TR",null,d.Ca("TD",a.LABEL,d.Ca("LABEL",{id:m},"Replace with")),d.Ca("TD",null,this.Na)),d.Ca("TR",null,d.Ca("TD",null,d.Ca("LABEL",
{id:r},"Search")),d.Ca("TD",null,u,w)),d.Ca("TR",null,d.Ca("TD",null,""),d.Ca("TD",null,b,d.Ca("BR"),e,d.Ca("BR"),h,l,d.Ca("BR"),f)),d.Ca("TR",null,d.Ca("TD",{colspan:"2"},this.sb))));this.F.render(u);Nh(this.F.getElement(),a.Zta);this.O.render(w);Mi(this.ma,b);ht(this.ma,b);this.ma.getElement().id=a.Tua;Mi(this.Da,e);ht(this.Da,e);this.Da.getElement().id=a.Uua;Mi(this.L,h);ht(this.L,h);this.L.getElement().id=a.wva;ht(this.J,f);Mi(this.J,f);Gh(this.C,"labelledby",k);Gh(this.Na,"labelledby",m);Gh(this.F.Pa(),
"labelledby",r);d.appendChild(c,l);c=new lq;c.set("findNext","Find",!0);c.set("replace","Replace");c.set("replaceAll","Replace all");c.set("done","Done",!1,!0);oq(this,c);zq(this,"");this.getHandler().R(this,"dialogselect",this.GYb).R(this.hc,"input",this.Kma).R(this.L,"change",this.jAb).R(this.F,"change",this.nqb).R(this.O,"change",this.HYb).R(this.J,"change",this.kAb);c=new Rr;c.gb(this.C);this.Aa(c);c=new Rr;c.gb(this.Na);this.Aa(c);PQd(this);c=new aq(this.getElement());this.Aa(c);this.getHandler().R(c,
"focusin",this.UTa).R(this.getElement(),"mousedown",this.UTa)}x(NQd,cq);var OQd={qta:"waffle-find-replace-dialog-border",Zta:"waffle-find-replace-find-scope-select",sua:"waffle-input-error",LABEL:"waffle-find-replace-dialog-label",Tua:"find-replace-case",Uua:"find-replace-cell",wva:"find-replace-regex",J_a:"waffle-find-replace-selection-input goog-inline-block"};
function PQd(a){var b=JD(a.Sa),c=null,d=null;b&&(c=iTb(b),d=VF(a.mb,c.C).$d());a.J.wc(a.Eb);var e=new Nk("All sheets",mcb.UUa),f=new Nk("This sheet",mcb.S_a),h=new Nk("Specific range",mcb.cE);a.F.ud(e);a.F.ud(f);a.F.ud(h);f=c?HG(a.mb,c.C):null;f=(f=c&&f?mF(f,c.rect.xc(),c.rect.rc()):null)?f.gh():1;c&&c.rect.gh()>f?rr(a.F,h):rr(a.F,e);b&&a.O.Qa(gG(c.rect,d))}function QQd(a){var b=a.F.Qe().Ta(),c=XF(a.Sa.C);return 0==b?eG(a.O.getValue(),a.mb,!1,!0):1!=b||null===c?null:new Vw(c,new Bw(0,0,1,1))}p=NQd.prototype;
p.UTa=function(a){a.target==this.getElement()?this.focus():this.Tb.Nb(2)};p.HYb=function(){RQd(this)};p.kAb=function(){var a=this.J.isChecked();kfc(this.Ra,a)};p.nqb=function(){RQd(this)};p.jAb=function(){this.L.isChecked()&&this.ma.wc(!0);this.Kma()};
p.GYb=function(a){var b=SQd;if("findNext"==a.key)a.preventDefault(),this.Jb&&(O2(this,null),TQd(this,b.Yta));else if("replace"==a.key)a.preventDefault(),this.zb&&(O2(this,null),TQd(this,b.lva));else if("replaceAll"==a.key&&(a.preventDefault(),this.Pb)){a=v(function(){O2(this,null);TQd(this,b.kva)},this);var c=this.F.Qe().Ta();1<this.mb.D.length&&2==c&&!this.yb?(kAc("Replace on all sheets?","This will replace values on all sheets. Are you sure?",a,null),this.yb=!0):a()}};
p.Kma=function(){var a=0==this.C.value.length,b=this.L.isChecked()&&!ritz_api.RitzModelApi.isValidRegex(this.C.value);a=!a&&!b;pq(this.D,"findNext").disabled=!a;this.Jb=a;UQd(this,a);this.zb&&!a&&VQd(this,!1);Rh(this.C,"waffle-input-error",b)};p.FYb=function(a,b,c){this.Ua=a.wr();this.Hc.Lba(this,a,b,c,!1,!0)};
function RQd(a){var b=0==a.F.Qe().Ta();a.O.setVisible(b);C(a.xa);a.xa=null;var c=QQd(a),d=JD(a.Sa);b&&d&&c&&(a.xa=qL(d,c.rect,"waffle-find-replace-dialog-border",2,1),a.xa.setVisible(!0),a.Aa(a.xa))}function TQd(a,b){if(0==a.F.Qe().Ta()&&null==QQd(a))Rh(a.O.D,"waffle-range-selection-error",!0),O2(a,"Invalid range");else{var c=a.F.Qe().Ta();a.dispatchEvent(new WQd(b,a.C.value,a.Na.value,c,a.ma.isChecked(),a.Da.isChecked(),a.L.isChecked(),a.J.isChecked(),QQd(a)))}}
p.setVisible=function(a){var b=this.Ra.Ld();UQd(this,!b);VQd(this,!b);this.Na.disabled=b;NQd.oa.setVisible.call(this,a);a&&this.Ua&&(this.Ua.focus(),this.Ua=null)};p.JSb=function(a){this.C.value=a};p.sQa=function(){this.C.select()};p.focus=function(){this.Mb()&&this.isVisible()&&(this.C.focus(),this.Tb.Nb(2),ns(this.C,this.C.value.length),this.Kma())};function VQd(a,b,c){b=b&&!a.Ra.Ld()&&0==!a.C.value.length;a.zb=b;a=pq(a.D,"replace");a.disabled=!b;c?a.title=c:a.removeAttribute("title")}
function UQd(a,b){b=b&&!a.Ra.Ld()&&0==!a.C.value.length;a.Pb=b;pq(a.D,"replaceAll").disabled=!b}function O2(a,b){var c=Rd(a.Lb());a=a.sb;b?(0<qe(a).length&&c.appendChild(a,c.Ca("BR")),c.appendChild(a,c.Ca("B",null,Je(c,b)))):c.Bd(a)}p.Ha=function(){NQd.oa.Ha.call(this);this.yb=!1;kfc(this.Ra,this.Eb)};function WQd(a,b,c,d,e,f,h,k,l){D.call(this,a);this.D=b;this.F=c;this.C=d;this.O=e;this.V=f;this.Da=h;this.Fa=k;this.Ka=l||null}x(WQd,D);
var SQd={Yta:"findnext",Ldc:"findall",lva:"replace",kva:"replaceall",DONE:"done",X4b:"canceled"};function XQd(a,b,c,d,e){A.call(this);var f=SQd;this.F=null;this.C=a;this.D=b;this.H=c;this.O=d;this.L=e;this.J=new Uh(this);this.Aa(this.J);this.J.R(a,f.kva,this.qzb).R(a,f.lva,this.rzb).R(a,f.Yta,this.TTa).R(a,f.DONE,this.uob)}x(XQd,A);var P2={uN:"cg",vN:"cr",tN:"cc",Xta:"loop"};p=XQd.prototype;p.FUb=function(){this.C.setVisible(!0);YQd(this,null)};p.TTa=function(a){if(KD(this.D.C)){var b=JD(this.D).Ta(),c=this.F;c||(c=DF(b),c=Gc(P2.uN,b.Ac(),P2.vN,b.L.C[c.y],P2.tN,b.qe.C[c.x]));ZQd(this,a,b,c)}};
function ZQd(a,b,c,d){var e=new jv,f=$Qd(b);aRd(f,c,d);c=e.serialize(f);a=v(function(a){var c=e.xd((new pcb).Ba(),a);a=U(f,1);var d=b.type;KD(this.D.C)&&(c?bv(c,1)?(d=U(c,1),c=Gc(P2.uN,d.Db(),P2.vN,d.$p(),P2.tN,d.getColumnIndex(),P2.Xta,U(c,2)),bRd(this,a,c)):(bRd(this,a,{}),"replace"==d&&this.C.focus()):cRd(this))},a);ritz_api.RitzModelApi.findNext(c,a)}function aRd(a,b,c){if(c){var d=c[P2.uN],e=new tw;V(e,1,d);V(e,2,FPd(b,c[P2.vN],"r"));V(e,3,FPd(b,c[P2.tN],"c"));V(a,10,e)}}
function $Qd(a){var b=new xC;V(b,1,a.D);V(b,3,a.F);V(b,5,a.C);if(0==a.C||1==a.C){var c=a.Ka,d=new Av;V(d,1,c.C);var e=c.rect.xc();V(d,2,e);Bv(d,c.rect.Yc());d.lr(c.rect.rc());d.Ax(c.rect.ad());b.setSelection(d)}V(b,6,a.O||!1);V(b,7,a.V||!1);V(b,8,a.Da||!1);b.setType(a.Fa?1:0);V(b,11,0);return b}function bRd(a,b,c){c?c&&null!=c.cg?(b=c[P2.uN],c[P2.Xta]&&O2(a.C,"No more results found, looping around"),a.H.iA(b,v(a.EYb,a,c))):(YQd(a,null),O2(a.C,"There are no entries matching "+b)):cRd(a)}
p.EYb=function(a){var b=JD(this.D).Ta(),c=a[P2.vN],d=a[P2.tN];a[P2.vN]=b.L.C[c];a[P2.tN]=b.qe.C[d];YQd(this,a);a=new Kd(d,c);b=new Vw(b.Ac(),Ew(a));KR(this.H,b,v(this.r2a,this,a))};
p.r2a=function(a){if(!this.isDisposed()){this.C.focus();var b=JD(this.D).Ta();VE(b.ah(a.y,a.x))&&!this.C.J.isChecked()&&VQd(this.C,!1,"Can't replace formula");var c=oF(b,a.y),d=pF(b,a.x);!c||!d||c.isVisible()&&d.isVisible()||(c=this.C,d=fG(a),a=UE(xF(b,a)),O2(c,"A match was found in hidden cell "+(d+(' with value "'+(a+'".')))))}};function cRd(a){O2(a.C,null);O2(a.C,"Error while searching spreadsheet. Please try again.")}
p.rzb=function(a){if(!this.L.Ld()){var b=this.F;if(b){var c=QE(this.H,b[P2.uN]);if(c){var d=c.Jc(),e=FPd(d,b[P2.vN],"r"),f=FPd(d,b[P2.tN],"c");c=d.ah(e,f);if(!VE(c)||this.C.J.isChecked()){c=UE(c);var h=new jv,k=$Qd(a);V(k,5,0);aRd(k,d,b);d=new Av;V(d,1,b[P2.uN]);V(d,2,e);Bv(d,e+1);d.lr(f);d.Ax(f+1);k.setSelection(d);b=h.serialize(k);b=ritz_api.RitzModelApi.getReplaceResult(b);dRd(this,k,c,b,!1);this.TTa(a)}}}}};p.qzb=function(a){if(!this.L.Ld()&&KD(this.D.C)){var b=$Qd(a);dRd(this,b,a.D,a.F,!0)}};
function dRd(a,b,c,d,e){b=new dMc(b);DD(b,v(function(a,b){a?(a=U(b,5),b=U(b,4),b=0==a?"No matches found":e?(new Rs(1==b?"{NUM_CHANGED,plural, =0{unused plural form}=1{Replaced one instance of {ORIGINAL_VALUE} with {NEW_VALUE}}other{Replaced # instances of {ORIGINAL_VALUE} with {NEW_VALUE}}}":"{NUM_SHEETS,plural, =0{unused plural form}=1{unused plural form}other{Replaced {NUM_CHANGED} instances of {ORIGINAL_VALUE} with {NEW_VALUE} across # sheets}}")).format({NUM_CHANGED:a,NUM_SHEETS:b,ORIGINAL_VALUE:c,
NEW_VALUE:d}):'Replaced "'+(c+('" with "'+(d+'"'))),O2(this.C,null),O2(this.C,b)):cRd(this)},a));O2(a.C,null);O2(a.C,"Working...");a.O.C(b)}p.uob=function(){YQd(this,null)};function YQd(a,b){a.F=b;(a=a.C)&&VQd(a,null!=b)};function eRd(a,b,c){IPd.call(this);dq(this,"Grouping rule");this.xa=a;this.Na=b;this.Da=c;this.ma=new M;this.Ga(this.ma,!0);this.F=new fRd("Minimum value","e.g. 0",!0);this.ma.Ga(this.F,!0);this.L=new fRd("Maximum value","e.g. 100",!0);this.ma.Ga(this.L,!0);this.J=new fRd("Interval size","e.g. 10",!1);this.Ga(this.J,!0);(a=this.xa.C.getActiveGrid())&&(a=SF(a.Jc()))&&(a=gRd(this,a))&&bv(a,10)&&bv(Rx(a),3)&&(a=U(Rx(a),3),bv(a,1)&&(b=U(a,1),this.F.D.Qa(qU.format(b))),bv(a,2)&&(b=U(a,2),this.J.D.Qa(qU.format(b))),
bv(a,3)&&(a=U(a,3),this.L.D.Qa(qU.format(a))))}q(eRd,IPd);
eRd.prototype.A7=function(){var a=hRd(this.F),b=hRd(this.J),c=hRd(this.L);if(isNaN(a)||isNaN(b)||isNaN(c))var d=!1;else 0>=b?(iRd(this.J,"Must be greater than 0"),d=!1):null!=a&&null!=c&&a>=c?(iRd(this.F,"Value too large"),d=!1):d=!0;if(d){d=new Sx;d.setType(2);var e=new Vx;null!=a&&V(e,1,a);null!=b&&V(e,2,b);null!=c&&V(e,3,c);V(d,3,e);if(a=this.xa.C.getActiveGrid())if(a=a.Jc(),b=SF(a))if(c=gRd(this,b))V(c,10,d),this.Na.C(new IM(b,a)),$z("Pivot table headings grouped.");IPd.prototype.A7.call(this)}};
function gRd(a,b){b=hkb(b,function(b){return b.XX()==a.Da});if(0==b.length)return null;if(1==b.length)return b[0];if(2==b.length)return bv(b[0],10)?b[0]:b[1]}function fRd(a,b,c,d){M.call(this,d);this.L=a;this.O=b;this.V=c;this.J=new M;this.Ga(this.J,!0);this.D=new xT;this.Ga(this.D,!0);this.H=null;this.C=new M;this.Ga(this.C,!0);this.F=new gS(this.qa(),!0,!0);this.Aa(this.F)}q(fRd,M);
fRd.prototype.Ia=function(){M.prototype.Ia.call(this);this.Pa().className="waffle-pivot-histogram-errorable-input";this.J.Pa().className="waffle-pivot-histogram-dialog-caption";this.qa().Oe(this.J.getElement(),this.L);this.H=this.D.Pd().FL(this.D.Pa());this.H.placeholder=this.O;Kh(this.H,this.L+" - "+this.O);jS(this.F,this.H);this.C.Pa().className="waffle-pivot-histogram-dialog-error";Fh(this.C.Pa(),"alert");Gh(this.C.Pa(),"live","polite");jRd(this)};
function hRd(a){jRd(a);var b=a.D.getValue();if(Kb(b)){if(a.V)return null;iRd(a,"Required");return NaN}b=qU.parse(b);isNaN(b)&&iRd(a,"Must be a number");return b}function iRd(a,b){a.C.Pa().style.visibility="";a.qa().Oe(a.C.Pa(),b);hS(a.F,b,!1)}function jRd(a){a.C.Pa().style.visibility="hidden";iS(a.F)};function kRd(a){a=a||{};var b=a.type;return P('<input class="'+Q("jfk-textinput")+(a.Fd?" "+Q(a.Fd):"")+'"'+(a.id?' id="'+Q(a.id)+'"':"")+(a.maxLength?' maxlength="'+Q(a.maxLength)+'"':"")+(a.s$&&a.eWb?' label="'+Q(a.s$)+'"':"")+(a.name?' name="'+Q(a.name)+'"':"")+(a.s$?' placeholder="'+Q(a.s$)+'"':"")+' type="'+Q(null!=b?b:"text")+'"'+(a.pattern?' pattern="'+Q(a.pattern)+'"':"")+(a.value?' value="'+Q(a.value)+'"':"")+(a.dir?' dir="'+Q(a.dir)+'"':"")+(a.attributes?" "+UDa(a.attributes):"")+">")};function lRd(a){a=""+mRd({id:"waffle-resize-selection-custom",JKa:a.Pga,Pk:Sq("<br/>"+O(kRd({id:"waffle-resize-input",Fd:"waffle-resize-inset-input"})))});a+=mRd({id:"waffle-resize-selection-auto",JKa:Rq("Fit to data"),Pk:Sq("")});return P(a)}function mRd(a){return P('<div class="waffle-resize-option"><input type="radio" name="waffle-resize-selection" id="'+Q(a.id)+'"><label for="'+Q(a.id)+'" class="waffle-resize-label">'+O(a.JKa)+"</label>"+O(a.Pk)+"</div>")}
function nRd(a){var b=a.Gcb;a='<label for="waffle-resize-input">'+O(a.Pga)+'</label><br/><br/><input id="waffle-resize-input"/>';b&&(a+='<br/><br/><span class="waffle-resize-dialog-checkbox"><span id="waffle-resize-rows-can-grow-checkbox">Allow row heights to grow automatically to fit cell contents.</span></span>');return P(a)};function oRd(a,b,c,d,e){cq.call(this);this.L=a;this.Da=b;var f=Nw(this.L.Nc());this.C=f;this.F=Ua(zF(this.L),function(a){return Nw(a)==f});this.J=new xP;this.O=new $Lc(!0);this.ma=new jt;this.Na=c;this.Ra=d;this.xa=e}x(oRd,cq);var pRd={AUTO:"waffle-resize-selection-auto",Qo:"waffle-resize-selection-custom",rua:"waffle-resize-input",BZa:"waffle-resize-selection",B_a:"waffle-resize-rows-can-grow-checkbox"};p=oRd.prototype;
p.Ca=function(){oRd.oa.Ca.call(this);var a=this.F[0];if("r"==this.C){var b=a.xc();a=a.Yc()-1;var c=String($F(b+1)),d=String($F(a+1));b=1<this.F.length?"Resize selected rows":b==a?"Resize row "+c:"Resize rows "+(c+(" - "+d))}else b=a.rc(),a=a.ad()-1,c=bG(b),b=1<this.F.length?"Resize selected columns":b==a?"Resize column "+c:"Resize columns "+(c+(" - "+bG(a)));dq(this,b);"r"==this.C?this.Lb().appendChild(N(nRd,{Pga:qRd(this),Gcb:I(H(),"fefrh")})):this.Lb().appendChild(N(lRd,{Pga:qRd(this)}));zq(this,
"ok")};p.Ia=function(){oRd.oa.Ia.call(this);var a=this.qa(),b="r"==this.C;this.J.gb(a.getElement(pRd.rua));I(H(),"fefrh")&&b&&(a=a.getElement(pRd.B_a),ht(this.ma,a),Mi(this.ma,a));a=this.L.Nc();var c=Nw(a);a=Yfb(Dlb(this.L,c,Lw(a,c)));this.J.Qa(String(a));b||(aMc(this.O,pRd.BZa),bMc(this.O,pRd.Qo));this.getHandler().R(this,"dialogselect",this.MYb).R(this.J.getElement(),"focus",this.jEb)};p.jEb=function(){"c"==this.C&&bMc(this.O,pRd.Qo)};p.focus=function(){this.Mb()&&BP(this.J)};
function qRd(a){return"r"==a.C?"Enter new row height in pixels. (Default: "+(aF+")"):"Enter new column width in pixels. (Default: "+($fb+")")}
p.MYb=function(a){if("ok"==a.key)if((a="r"==this.C)||cMc(this.O)==pRd.Qo){var b=parseInt(this.J.getValue(),10);isNaN(b)?Zz("Entered value is not a number."):2>b||2E3<b?Zz("Size must be between 2 and 2000 pixels."):(this.xa.C("r"==this.C?35310:35308),b=new SM(this.L,this.F[0],b,this.F.slice(1)),I(H(),"fefrh")&&a&&(a=!this.ma.isChecked(),b.L=a),this.Da.C(b))}else JD(this.Na),this.xa.C(35307),$Xb(this.F,this.Ra,this.Da)};function rRd(a){Vf(this,a,0,-1,null,null)}x(rRd,Uf);rRd.prototype.getType=function(){return F(this,3)};rRd.prototype.setType=function(a){G(this,3,a)};function sRd(a){M.call(this,a);this.$=Fz("email");this.C=this.D=null}x(sRd,M);p=sRd.prototype;
p.Ca=function(){var a=this.qa();var b=this.qa();this.C=new $S;this.Aa(this.C);this.D=new $S;this.Aa(this.D);var c=b.Ca("DIV","waffle-dialog-notifications-input");Fh(c,"presentation");this.F=new YS;ZS(this.F,b.Ca("LABEL",null,"Any changes are made"));this.F.render(c);this.C.IG(this.F);var d=b.Ca("DIV","waffle-dialog-notifications-input");Fh(d,"presentation");this.J=new YS;ZS(this.J,b.Ca("LABEL",null,"A user submits a form"));this.J.render(d);this.C.IG(this.J);var e=b.Ca("DIV","waffle-dialog-notifications-input");
Fh(e,"presentation");this.H=new YS;ZS(this.H,b.Ca("LABEL",null,"Email - daily digest"));this.H.render(e);this.D.IG(this.H);var f=b.Ca("DIV","waffle-dialog-notifications-input");Fh(f,"presentation");this.L=new YS;ZS(this.L,b.Ca("LABEL",null,"Email - straight away"));this.L.render(f);this.D.IG(this.L);b=b.Ca("DIV",null,b.Ca("DIV","waffle-dialog-notifications-toplabel","Notify me at "+(this.$+" when...")),b.Ca("DIV",{role:"radiogroup","aria-label":"Notify me at "+(this.$+" when...")},c,d),b.Ca("DIV",
{style:"padding: 5px"}),b.Ca("DIV","waffle-dialog-notifications-label","Notify me with..."),b.Ca("DIV",{role:"radiogroup","aria-label":"Notify me with..."},e,f));c=this.qa();d=c.Ca("DIV");this.O=gP("Save",c);this.Ga(this.O,!1);this.O.render(d);this.V=new cr("Cancel",c);this.Ga(this.V,!1);this.V.render(d);a=a.Ca("DIV","waffle-dialog-notifications",a.Ca("DIV",null,b),a.Ca("DIV",null,d));this.Hb(a)};
p.Ia=function(){sRd.oa.Ia.call(this);this.getHandler().R(this.O,"action",this.QRb,!0).R(this.V,"action",v(this.dispatchEvent,this,new D("cancelRuleEdit"))).R(this.C,"change",this.Fsa).R(this.D,"change",this.Fsa)};p.Ec=function(a){sRd.oa.Ec.call(this,a);a?1==a.getType()?aT(this.C,this.F):2==a.getType()&&aT(this.C,this.J):aT(this.C,null);a?2==F(a,2)?aT(this.D,this.H):1==F(a,2)&&aT(this.D,this.L):aT(this.D,null);this.Fsa()};p.focus=function(){var a=bT(this.C),b=this.C.C.Ve(0);(a||b).getElement().focus()};
p.setVisible=function(a){this.getElement()&&L(this.getElement(),a)};p.QRb=function(){this.dispatchEvent(new D("saveRule",tRd(this)))};function tRd(a){var b=new rRd,c=a.Ta();c&&(c=F(c,1),G(b,1,c));a.F.isChecked()?b.setType(1):a.J.isChecked()&&b.setType(2);a.L.isChecked()?G(b,2,1):a.H.isChecked()&&G(b,2,2);return b}p.Fsa=function(){var a=(this.F.isChecked()||this.J.isChecked())&&(this.L.isChecked()||this.H.isChecked());this.O.Oa(a)};function uRd(a){return P("<div><div>"+O(a.K4a)+"</div>"+O(it({id:"waffle-confirm-suppress-checkbox",Fd:"waffle-confirm-suppress-checkbox"},void 0))+'<span id="waffle-confirm-suppress-label">'+O(a.Gra)+"</span></div>")};function vRd(a,b,c,d,e,f,h){if(ya(c)){var k=new lq;k.set("ok",c.ok,!0);k.set("cancel",c.cancel,!1,!0)}else k=$Ca;return wRd(d||"Heads up!",a,b,k,e,f,h)}function wRd(a,b,c,d,e,f,h){b=qd(b);if(f){b=Dq(uRd({K4a:b,Gra:f}));var k=new jt;var l=c;c=function(){l(k.isChecked())}}a=pDa(a,b,c,e||null,void 0,void 0,d,h);k&&(a.Ga(k),k.gb(Fe(a.qa(),"waffle-confirm-suppress-checkbox")),c=Fe(a.qa(),"waffle-confirm-suppress-label"),ht(k,c),k.wc(!1));return a};function Q2(a,b){M.call(this,b);this.Ec(a)}x(Q2,M);
Q2.prototype.Ca=function(){var a=this.Ta(),b="";1==a.getType()?b="any changes are made":2==a.getType()&&(b="form submitted");var c="";2==F(a,2)?c+="send digest email":1==F(a,2)&&(c+="send email");c="If "+(b+(" then "+c));var d=this.qa();a=d.Ca("TD",null);b=d.Ca("TD",{width:"50px"});c=d.Ca("TR",{valign:"center"},d.Ca("TD",null,d.Ca("SPAN","waffle-notification-rule",c)),d.Ca("TD",{align:"right"},d.Ca("TABLE",null,d.Ca("TBODY",null,d.Ca("TR",null,a,b)))));d=Si(Lq,"waffle-notifications-add");this.D=new Mq("Edit",
d,this.qa());this.D.Ed("goog-link-button");this.D.Ed("menuMainLink");this.Ga(this.D,!1);this.D.render(a);this.C=new Mq("Delete",d,this.qa());this.C.Ed("goog-link-button");this.C.Ed("menuMainLink");this.Ga(this.C,!1);this.C.render(b);this.Hb(c)};Q2.prototype.Ia=function(){Q2.oa.Ia.call(this);this.getHandler().R(this.D,"action",this.H);this.getHandler().R(this.C,"action",this.F)};Q2.prototype.H=function(){this.dispatchEvent(new D("edit",this.Ta()))};
Q2.prototype.F=function(){var a=v(function(){this.dispatchEvent(new D("del",this.Ta()))},this),b=v(function(){this.C.getElement().focus()},this);vRd("Are you sure that you want to delete this notification rule?",a,void 0,void 0,b)};function xRd(a){M.call(this,a);this.C=null}x(xRd,M);xRd.prototype.Ca=function(){var a=this.qa();this.C=a.Ca("TBODY");a=a.Ca("TABLE",{className:"waffle-dialog-notifications-list",width:"100%"},this.C);this.Hb(a)};xRd.prototype.Lb=g("C");xRd.prototype.setVisible=function(a){this.getElement()&&L(this.getElement(),a)};function yRd(a,b,c){cq.call(this);this.L=b;dq(this,"Set notification rules");kq(this,!1);a=new lq;a.set("cancel","Done",!1,!0);oq(this,a);this.C=new sRd(c);this.Ga(this.C,!1);this.F=new xRd;this.Ga(this.F,!1);this.J=new Mq("Add another notification rule",GN.getInstance(),this.qa());this.Ga(this.J,!1)}x(yRd,cq);p=yRd.prototype;
p.Ca=function(){yRd.oa.Ca.call(this);var a=this.qa(),b=Hub(new Fl(g4a+"91588")).toString();b=a.Ca("A",{target:"_blank",href:b},"Help");var c=a.Ca("DIV");this.J.render(c);this.ma=a.Ca("DIV");this.O=a.Ca("DIV");var d=a.Ca("DIV","waffle-dialog-notifications-bounds",this.ma,this.O);b=a.Ca("DIV",null,a.Ca("DIV",{align:"right"},b),d,c);a.appendChild(this.Lb(),b);zq(this,"")};
p.Ia=function(){yRd.oa.Ia.call(this);this.F.render(this.ma);this.C.render(this.O);this.getHandler().R(this,"edit",this.PYb).R(this,"del",this.OYb).R(this.J,"action",this.NYb).R(this,"saveRule",this.PRb).R(this,"cancelRuleEdit",this.U3a)};p.r_=function(a){this.isDisposed()||(this.C.setVisible(!1),zRd(this,!1),vz(this.L,"/notifications/list",v(this.NVb,this,a)).Ee())};
p.NVb=function(a,b,c){if(!this.isDisposed()){b=c.Ye();c=[];for(var d=0;d<b.length;d++)c[d]=new rRd(b[d]);this.Ec(c);if(a&&0==c.length)ARd(this,null,!1);else{if(a=this.Ta())if(b=this.F,b.Bd(!0),b.qa().Bd(b.Lb()),b.Ec(a),c=b.qa(),0==a.length)c.appendChild(b.Lb(),c.Ca("TR",null,c.Ca("TD",{align:"center"},"No notification rules currently defined")));else for(d=0;d<a.length;d++)b.Ga(new Q2(a[d],c),!0);zRd(this,!0);this.focus()}}};
p.PRb=function(a){this.C.setVisible(!1);a=a.target;var b=a.serialize();F(a,1)?lt(vz(this.L,"/notifications/set",v(this.r_,this,!1)),{rule:b}).Ee():lt(vz(this.L,"/notifications/create",v(this.r_,this,!1)),{rule:b}).Ee()};p.U3a=function(){this.C.setVisible(!1);this.r_(!1)};p.PYb=function(a){ARd(this,a?a.target:null,!0)};p.NYb=function(){ARd(this,null,!0)};function ARd(a,b,c){zRd(a,!1);var d=a.C;d.Ec(b);d.setVisible(!0);c&&a.C.focus()}
p.OYb=function(a){this.F.setVisible(!1);a=a.target;lt(vz(this.L,"/notifications/delete",v(this.r_,this,!1)),{rule_id:F(a,1)}).Ee()};function zRd(a,b){a.F.setVisible(b);var c=hq(a);L(c,b);a.J.setVisible(b)}p.show=function(){this.setVisible(!0);this.r_(!0)};function BRd(a,b,c,d,e){CD.call(this,68);this.O=a;this.L=b;this.D=c;this.H=d;this.C=e}x(BRd,CD);BRd.prototype.Td=function(){var a=new jD;this.O&&V(a,1,this.O);t(this.L)&&V(a,2,this.L);t(this.D)&&V(a,3,this.D);this.H&&V(a,4,this.H);t(this.C)&&V(a,5,this.C);return a};BRd.prototype.QZ=function(a,b){(t(this.D)||t(this.H)||t(this.C))&&ritz_api.RitzModelApi.requestCalculation(!0);BRd.oa.QZ.call(this,a,b)};function CRd(a,b,c){b=c||b;c='<tr class="dialog-settings-general-settings-div"><div>';var d='<span id="ds-settings-link-desc">Display language: </span><a aria-labelledby="ds-settings-link-desc ds-settings-link" id="ds-settings-link" target="_blank">'+(O(a.T5a)+"</a>");c=c+d+"</div>";a.FTb&&(c+='<div class="dialog-settings-english-name-div">'+O(it({id:"waffle-settings-dialog-english-name-checkbox"},b))+'<label for="waffle-settings-dialog-english-name-checkbox" id="waffle-settings-dialog-english-name-checkbox-label">',
c+="Always use English function names</label></div>");return P(c+"</tr>")}function DRd(){return P('<div id="spreadsheet-settings-tab-bar" class="spreadsheet-settings-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="general-settings-tab" class="spreadsheet-settings-tab goog-tab goog-tab-selected">General</div><div id="calculation-settings-tab" class="spreadsheet-settings-tab goog-tab">Calculation</div></div>')};function R2(a,b,c,d){cq.call(this);this.Jb=a;this.Sc=b;this.ma=c;this.hc=d;this.C={};this.zb=this.mb=!1;this.Tb=this.Eb=this.yb="";this.Hc=new jv;this.J=[];this.F=this.Hc.xd((new mw).Ba(),ritz_api.RitzModelApi.getWorkbookProperties());dq(this,"Settings for this spreadsheet");this.Ua=!1;this.Ra=new jt;this.Ga(this.Ra);this.O=new gS;this.Ga(this.O);this.L=new gS;this.Ga(this.L);this.sb=new wS;this.Ga(this.sb);this.Na=this.Sa=null;this.Pb=new Ps(1);this.xa=this.Da="";this.C[0]=H2();this.C[1]=H2();this.C[2]=
H2();this.C[3]=H2();this.C[4]=new xP;this.C[5]=new xP}x(R2,cq);var ERd=null,FRd={B2:0,$0a:1,aVa:2,pYa:3,JYa:4,fWa:5},GRd={E1a:"waffle-settings-dialog-english-name-checkbox",F1a:"waffle-settings-dialog-english-name-checkbox-label"},HRd=[{value:"",caption:"On change"},{value:"60000",caption:"On change and every minute"},{value:"3600000",caption:"On change and every hour"}],IRd=[{value:"ON",caption:"On"},{value:"OFF",caption:"Off"}];p=R2.prototype;
p.Ca=function(){R2.oa.Ca.call(this);var a=this.Lb(),b=this.qa(),c=[JRd(b,"Locale","waffle-settings-label-locale"),KRd(this,b,"This affects formatting details such as functions, dates and currency.",0,"waffle-settings-label-locale","waffle-settings-description-locale"),LRd(this),JRd(b,"Time zone","waffle-settings-label-timezone"),KRd(this,b,"Your spreadsheet's history will be recorded in this time zone. This will change all time-related functions.",1,"waffle-settings-label-timezone","waffle-settings-description-timezone"),
LRd(this)],d=[];d.push(JRd(b,"Recalculation","waffle-settings-label-autorecalc"));d.push(KRd(this,b,"This affects how often NOW, TODAY, RAND and RANDBETWEEN are updated.",2,"waffle-settings-label-autorecalc","waffle-settings-description-autorecalc"));d.push(LRd(this));d.push(JRd(b,"Iterative calculation","waffle-settings-label-iterativecalc"));var e=Hub(new Fl(g4a+"58515")).toString();e=b.Ca("A",{target:"_blank",href:e}," Learn more about iterative calculation.");d.push(KRd(this,b,"Determines whether formulas with circular references are resolved by iterative calculation.",
3,"waffle-settings-label-iterativecalc","waffle-settings-description-iterativecalc",e));e=JRd(b,"Max. number of iterations","waffle-settings-label-maxiterations");d.push(e);this.J.push(e);e=KRd(this,b,"The maximum number of calculation rounds to perform during iterative calculation.",4,"waffle-settings-label-maxiterations","waffle-settings-description-maxiterations");MRd(e);d.push(e);this.J.push(e);e=JRd(b,"Threshold","waffle-settings-label-convergencethreshold");d.push(e);this.J.push(e);e=KRd(this,
b,"The threshold value such that calculation rounds stop when successive results differ by less.",5,"waffle-settings-label-convergencethreshold","waffle-settings-description-convergencethreshold");MRd(e);d.push(e);this.J.push(e);"OFF"==this.C[3].Qe().getValue()&&NRd(this);d.push(LRd(this));c=mb(c,d);c.push(N(CRd,{T5a:this.Eb,FTb:this.Ua}));this.Sa=b.Ca("TABLE","dialog-settings",b.Ca("TBODY",null,c));this.Na=b.Ca("table","dialog-settings",b.Ca("tbody",null,d));c=N(DRd);b.appendChild(a,c);this.sb.gb(c);
b.appendChild(a,this.Sa);b.appendChild(a,this.Na);L(this.Na,!1);ERd||(a=new lq(b),a.set("save","Save settings",!0),a.set("cancel","Cancel",!1,!0),ERd=a);oq(this,ERd);ORd(this,4,bv(this.F,3)&&U(this.F,3).f8()?U(this.F,3).T5().toString():"50");ORd(this,5,bv(this.F,3)&&U(this.F,3).d8()?U(this.F,3).G5().toString():"0.05");zq(this,"save")};function MRd(a){a=a.firstChild.firstChild;Nh(a,"jfk-textinput");ci(a,"width","7em")}function NRd(a){for(var b=0;b<a.J.length;b++)L(a.J[b],!1)}
function JRd(a,b,c){return a.Ca("TR",null,a.Ca("TD",{id:c,"class":"dialog-settings-label"},b))}function KRd(a,b,c,d,e,f,h){b=b.Ca("TR",null,b.Ca("TD","dialog-settings-input"),b.Ca("TD",{id:f,"class":"dialog-settings-text"},c,h));a=a.C[d];a.render(b.firstChild);a=a.Pa();Gh(a,"labelledby",e);Gh(a,"describedby",f);return b}function LRd(a){a=a.qa();return a.Ca("TR",null,a.Ca("TD",{colspan:2,"class":"dialog-settings-sep-td"},a.Ca("HR",{"class":"dialog-settings-sep"})))}
p.Ia=function(){R2.oa.Ia.call(this);lf(this,"dialogselect",v(this.QYb,this));this.getHandler().R(this.C[3],"action",this.UTb);this.getHandler().R(this.sb,"select",this.NCb);var a=this.C[4].getElement();this.O.Tj(a);jS(this.O,a,a);this.O.render();iS(this.O);this.getHandler().R(a,"change",v(this.jWb,this));a=this.C[5].getElement();this.L.Tj(a);jS(this.L,a);this.L.render();iS(this.L);this.getHandler().R(a,"change",v(this.iWb,this));if(this.Ua){a=this.qa().getElement(GRd.E1a);var b=this.qa().getElement(GRd.F1a);
this.Ra.gb(a);ht(this.Ra,b);this.Ra.wc(!r4a||Eub(this.ma.F))}};p.setVisible=function(a){if(a){if(!this.mb){PRd(this);return}var b=this.ma.L;ORd(this,0,b.C);b=b.H||c3b().name();ORd(this,1,b);ORd(this,2,bv(this.F,3)&&U(this.F,3).$la()?U(this.F,3).Fia().toString():"");ORd(this,3,bv(this.F,3)&&bv(U(this.F,3),1)?U(U(this.F,3),1)?"ON":"OFF":"OFF")}R2.oa.setVisible.call(this,a);this.mb&&!this.zb&&((a=Ud("ds-settings-link"))&&xd(a,this.yb),this.zb=!0)};
function PRd(a){as(Jt(a.Sc.$e("/info/settings"),QRd()),v(function(a){a=a.Ye();(a={locale:a.l?this.WJ(a.l):null,DSa:a.tz?this.WJ(a.tz):null,b6a:a.dls,NHb:a.dln,gWb:a.hl},a.locale)&&a.DSa&&(RRd(this,0,a.locale),RRd(this,1,a.DSa),RRd(this,2,HRd),RRd(this,3,IRd),this.yb=a.b6a,this.Eb=a.NHb,this.Tb=a.gWb,this.Ua=r4a&&ritz_api.RitzModelApi.isFunctionLocalizationSupportedForLocale(this.Tb),this.mb=!0);this.setVisible(!0)},a)).Ee()}
function QRd(){var a=Ql(Fz("win").location.href),b=Ol(a,"hl");a=Ol(a,"forcehl");return["hl",b,"forcehl",a]}function RRd(a,b,c){a=a.C[b];b=c.length;for(var d=0;d<b;d++){var e=c[d];e=new Nk(e.caption,e.value);a.ud(e);Fh(e.getElement(),"menuitem")}a.yc().getElement().style.overflow="auto";QO(a,!0)}p.WJ=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b.push({value:d[0],caption:d[1]})}return b};function ORd(a,b,c){(a=a.C[b])&&a.Qa(c)}
p.QYb=function(a){"save"==a.key&&("ON"!=this.C[3].Qe().getValue()||""==this.Da&&""==this.xa?(SRd(this),a=this.ma.L.C,this.Jb.C(TRd(this)),this.Jb.C(URd(this)),VRd(this,a)):(a.preventDefault(),SRd(this),""!=this.Da&&hS(this.O,this.Da,!0),""!=this.xa&&hS(this.L,this.xa,!0)))};p.UTb=function(a){if("ON"==a.target.getValue())for(a=0;a<this.J.length;a++)L(this.J[a],!0);else NRd(this);SRd(this)};function SRd(a){iS(a.O);iS(a.L)}
p.jWb=function(){this.Da="";var a=this.C[4].getValue()||"";a=this.Pb.parse(a);if(isNaN(a)||parseInt(a,10)!=a)this.Da="Please enter an integer value.";else if(0>=a||1E4<a)this.Da="Please enter a value between 1 and 10000."};p.iWb=function(){this.xa="";var a=this.C[5].getValue()||"";a=this.Pb.parse(a);isNaN(a)?this.xa="Please enter a numeric value.":0>a&&(this.xa="Please enter a non-negative value.")};
p.NCb=function(a){switch(a.target.getId()){case "general-settings-tab":L(this.Sa,!0);L(this.Na,!1);break;case "calculation-settings-tab":L(this.Sa,!1),L(this.Na,!0)}};function TRd(a){var b=a.C,c=b[FRd.aVa].Qe().getValue(),d=b[FRd.pYa].Qe().getValue();a=b[FRd.JYa].getValue()||"";b=b[FRd.fWa].getValue()||"";var e,f;""==c?f=!0:e=parseInt(c,10);c="ON"==d;return new BRd(e,f,c,isNaN(parseInt(a,10))||!c?void 0:parseInt(a,10),isNaN(parseFloat(b))||!c?void 0:parseFloat(b))}
function URd(a){var b=a.C;a=a.ma.L;var c=b[FRd.B2].Qe();c=null==c?a.C:c.getValue();b=b[FRd.$0a].Qe();b=null==b?a.H||c3b().name():b.getValue();return new k3b(c,b)}function WRd(a,b){a=a.C[0].Qe();return null!=a&&a.getValue()!=b}function VRd(a,b){(XRd(a)||WRd(a,b))&&msa(a.ma.D.C,function(){Fz("win").location.reload()})}function XRd(a){if(!a.Ua)return!1;var b=!r4a||Eub(a.ma.F),c=a.Ra.isChecked();return b!=c?(Mub(a.ma,c),b=Sj(new Rj,1).build(),a.hc.Wb(c?2433:2434,b),!0):!1}
p.Ha=function(){kc(this.C,C);delete this.C;R2.oa.Ha.call(this)};function YRd(a,b,c,d,e,f,h,k){cq.call(this,void 0,!1,k);this.J=this.L=this.ma=this.O=null;this.Na=a;this.C=b;this.xa=h;this.F=[];this.Da=new fkc(a,d,e,f)}q(YRd,cq);p=YRd.prototype;
p.Ca=function(){cq.prototype.Ca.call(this);var a=this.qa(),b=this.C.Nc(),c=fG(Sw(b)),d=fG(new Kd(b.left+b.width-1,b.top+b.height-1));dq(this,"Sort range from "+(c+(" to "+d)));ZRd||(c=new lq,c.set("save","Sort"),c.set("cancel","Cancel",!1,!0),ZRd=c);oq(this,ZRd);zq(this,"save");var e;c=a.Ca("DIV",{style:"overflow: hidden"},d=a.Ca("SPAN","jfk-checkbox"),e=a.Ca("SPAN",{style:"cursor: default"},"Data has header row"));var f=this.J=new jt(void 0,a);f.gb(d);ht(f,e);1==b.height&&f.Oa(!1);hI(this.Na,this.C.Ac(),
b)||(f.wc(!0),f.Oa(!1));I(H(),"fetdrisd")&&ritz_api.TablesApi.getTables((new jv).serialize(Zw(b,this.C.Ac())),v(function(a){if(0<a.length){var c=a[0];a=aP(c.getDimensionTableAccessor().getHeaderRange());if(c=ritz_api.TablesApi.isRowBased(c)&&1==yZa(Xw(a)))c=Zw(b,this.C.Ac()),c=a.Db()==c.Db()&&uZa(Xw(a),Xw(c))&&uZa(Yw(a),Yw(c));c&&f.wc(!0)}},this));d=this.Lb();a.appendChild(d,c);this.O=a.Ca("DIV",{style:"overflow-y:auto;overflow-x:hidden;max-height:300px"},a.Ca("TABLE",{cellSpacing:"0"},this.ma=a.Ca("TBODY")));
a.appendChild(d,this.O);c=$Rd(this);this.F.push(c);c=a.Ca("SPAN","menuMainLink waffle-sd-add","+ Add another sort column");a.appendChild(d,c);ze(c,!0);Fh(c,"button");this.L=c};p.Ia=function(){cq.prototype.Ia.call(this);this.getHandler().R(this,"dialogselect",this.xJb).jg(this.L,of,this.Pib).R(this.J,"change",this.orb)};
function $Rd(a){var b=a.qa(),c=0==a.F.length,d=new aSd(a,c,a.C,a.F.length,b),e=b.Ca("TR",null,b.Ca("TD",{colspan:"4"},b.Ca("DIV","waffle-sd-row-separator")));d.render(a.ma);b.appendChild(a.ma,e);c||a.getHandler().jg(d.D,of,v(a.v5a,a,d));a=bSd(a);cSd(d,a);return d}p.v5a=function(a){var b=this.F;if(1<b.length){var c=Sa(b,a);-1!=c&&(kb(b,c),b=a.getElement(),b=se(b),a.dispose(),ne(b),L(this.L,!0),this.L.focus(),$z("Sort criteria removed."))}};
function bSd(a){var b=a.C.Nc(),c=b.rc();b=b.ad();var d=Va(a.F,function(a){return a.Oj()},a);if(d)for(var e=Tlb(a.C,d[d.length-1]),f=e+1<b?e+1:c;f!=e;f=f+1<b?f+1:c){var h=a.C.qe.C[f];if(!bb(d,h))return h}return null}p.orb=function(){for(var a=this.F,b=0;b<a.length;b++)cSd(a[b])};p.Pib=function(){var a=Rw(this.C.Nc(),"c");a=Math.max(10,a);this.F.length<a&&(this.F.push($Rd(this)),$z("Sort criteria added."));pi(Ra(this.F).getElement(),this.O,!0);this.O.scrollLeft=0;this.F.length>=a&&L(this.L,!1)};
p.xJb=function(a){if("save"==a.key){a=[];for(var b=[],c=this.F,d=0;d<c.length;d++){var e=c[d];a.push(e.Oj());e=e.F.isChecked();b.push(e?1:0)}c=this.C.Nc();d=Rw(c,"r");this.J.isChecked()&&1<d&&(c=pZa(c,-1));d=Sj(new Rj,1).build();this.xa.Wb(this.J.isChecked()?35697:35698,d);a=new ekc(a,b,this.C,c,this.J.isChecked());gkc(this.Da,this.C,a)}};p.Ha=function(){cq.prototype.Ha.call(this);Cb(this.F)};var ZRd=null;
function aSd(a,b,c,d,e){M.call(this,e);this.J=this.L=this.F=this.C=this.D=null;this.V=-1;this.$=a;this.O=b;this.H=c}q(aSd,M);aSd.prototype.Oj=function(){var a=this.C.Qe();return a?a.getValue():-1};
aSd.prototype.Ca=function(){var a=this.qa(),b=this.O?"sort by":"then by",c,d,e,f=a.Ca("TR","waffle-sd-tr-rules",a.Ca("TD","waffle-sd-delete",this.O?"":this.D=a.Ca("SPAN",{title:"Remove sort criteria."},"x")),a.Ca("TD","waffle-sd-td-rules",a.Ca("LABEL",{id:Ni(this,"csl")},b)),b=a.Ca("TD","waffle-sd-column-selector"),a.Ca("TD","waffle-sd-td-ascending",e=a.Ca("DIV",null,c=a.Ca("DIV",{title:"Ascending"}),d=a.Ca("DIV",{title:"Descending"}))));Fh(e,"radiogroup");e=this.F=new YS(a,Ke(a,rp(uC(!0,this.re()))),
"ascending");e.render(c);a=this.L=new YS(a,Ke(a,rp(uC(!1,this.re()))),"descending");a.render(d);this.J=new $S([e,a]);aT(this.J,e);a=this.C=H2();a.render(b);Gh(a.getElement(),"label",this.O?"Select first column to sort by:":"Select next column to sort by:");this.D&&(ze(this.D,!0),Fh(this.D,"button"),Kh(this.D,"Remove sort criteria."));this.Hb(f)};
function cSd(a,b){var c=a.qa(),d=a.$.J.isChecked(),e=a.H.Nc(),f=e.xc(),h=e.rc();e=e.ad();a.V=b||a.Oj();for(b=a.C.Wh();0<b;b--)a.C.MB(0);for(;h<e;h++)b=Ub(UE(a.H.ah(f,h)),25),b=new Nk(Kb(b)||!d?"Column "+bG(h):b,a.H.qe.C[h],c),b.Ed("waffle-sd-menu-item"),a.C.ud(b);a.C.Te(0);0<=a.V&&a.C.Qa(a.V)}aSd.prototype.Ha=function(){M.prototype.Ha.call(this);this.C=this.D=this.H=this.$=null;C(this.F);C(this.L);C(this.J);this.J=this.L=this.F=null};function dSd(a,b,c){return oDa(a||"There was a problem",qd(b),void 0,void 0,void 0,void 0,c)};function eSd(a){return P("<li class='nfd-format-pill'><div class='nfd-format-display'>"+O(a.xdb)+"</div><div class='nfd-format-sample'>"+O(a.dRb)+"</div></li>")};function fSd(a,b,c){M.call(this);this.Ec(a);this.D=b;this.C=c}x(fSd,M);p=fSd.prototype;p.Ca=function(){var a=this.Ta(),b=this.C?eba(a.Qy(),30):a.Qy();a=this.C?dfc(a,this.D):"";b=N(eSd,{xdb:b,dRb:a});this.Hb(b)};p.Ia=function(){fSd.oa.Ia.call(this);ze(this.getElement(),!0);var a=new pk(this.getElement());this.Aa(a);this.getHandler().R(a,"key",this.cZb).R(this.getElement(),"mousedown",this.bZb).R(this.getElement(),"dblclick",this.vob)};
p.cZb=function(a){function b(a,b){for(;b=a(b);)if(Bi(b)){b.focus();break}}switch(a.keyCode){case 13:case 32:this.dispatchEvent("change");break;case 40:b(se,this.getElement());break;case 38:b(Wca,this.getElement())}};p.bZb=function(a){a.preventDefault();this.dispatchEvent("change")};p.vob=function(){this.dispatchEvent("action")};function gSd(a,b,c){M.call(this);this.D=b;this.C=c;hSd(this,a)}x(gSd,M);gSd.prototype.Ca=function(){var a=this.qa().Ca("UL","nfd-pill-container");this.Hb(a)};function hSd(a,b){z(b,function(b){a.Ga(new fSd(b,a.D,a.C),!0)})}gSd.prototype.filter=function(a){a=a.toLowerCase();this.kf(function(b){var c=Kb(Zb(a)),d=b.Ta().Qy().toLowerCase();c=c||Tb(d,a);L(b.getElement(),c)})};function S2(a){cq.call(this,"nfd-dialog modal-dialog");this.F=a;this.input=this.oga();this.Ga(this.input,!0);this.J=new M;this.Ga(this.J,!0);a=this.b6();rb(a,void 0,OPd);this.C=new gSd(a,this.bY(),this.ARa());this.J.Ga(this.C,!0);oq(this,null);this.Ai=!0}x(S2,cq);p=S2.prototype;p.$Ta=Qe;p.ARa=Pe;p.isEmpty=function(){return Kb(this.input.getValue())};p.hf=function(){return this.input.Ta().hf()};p.Ca=function(){S2.oa.Ca.call(this);var a=ce("DIV","dialog-separator");me(a,gq(this))};
p.Ia=function(){S2.oa.Ia.call(this);Nh(this.J.getElement(),"nfd-dialog-content");this.getHandler().R(this.C,"change",this.Aqb).R(this.C,"action",this.Gsa).R(this.input.O,"action",this.Gsa).R(this.input,"afterhide",this.bjb);this.input.V&&this.getHandler().R(this.input.V,"input",this.VYb);var a=this.input.xa;a&&this.getHandler().R(a,"key",this.WYb);a=this.b6()[0];this.input.sM(a)};p.bjb=function(a){a.stopPropagation()};p.Aqb=function(a){this.input.sM(a.target.Ta());iSd(this.input,!1)};
p.VYb=function(){this.C.filter(this.input.getValue());iSd(this.input,!this.input.Ta().hf())};p.WYb=function(a){13==a.keyCode&&this.Gsa()};p.Gsa=function(){this.hf()&&!this.isEmpty()?(O6a.Xb(new $O(this.V1(),void 0,this.$Ta())),this.setVisible(!1)):(iSd(this.input,!0),this.input.kCa())};function T2(a){M.call(this);this.J=new M;this.Aa(this.J);this.D=new xP("");this.Aa(this.D);this.O=new cr("");this.Aa(this.O);this.$=a;this.xa=null}x(T2,M);p=T2.prototype;
p.Ia=function(){T2.oa.Ia.call(this);var a=Pi(this,"nfd-icwr");this.J.gb(a);this.Ga(this.J);if(a=Pi(this,"nfd-i"))this.D.gb(a),this.D.Nd(this.J),Ph(this.D.getElement(),"jfk-textinput"),a=new Rr,a.gb(this.D.getElement()),this.Aa(a),this.V=a=new Qr(this.D.getElement()),this.Aa(a),this.xa=a=new pk(this.D.getElement()),this.Aa(a),a=new aq(this.D.getElement()),this.getHandler().R(a,"focusout",Ca(this.YTa,!1)).R(a,"focusin",Ca(this.YTa,!0)).R(this.V,"input",this.UYb);a=Pi(this,"nfd-a");this.O.gb(a);this.Ga(this.O)};
p.getValue=function(){return this.D.getValue()};p.UYb=function(){var a=this.Ta(),b=this.getValue();V(a.hH,2,b);this.ZTa()};p.ZTa=Qe;p.YTa=function(a){Rh(this.J.getElement(),"nfd-input-focus",a)};p.sM=function(a){this.Ec(a.clone());this.D.Qa(a.Qy());try{this.D.getElement().focus()}catch(b){}};p.kCa=function(){this.D.getElement().focus()};function iSd(a,b){a=a.J.getElement();Rh(a,"nfd-invalid",b)};function jSd(a,b,c){b=c||b;return P("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+Q(a.LZ)+"'>"+kSd(a)+"</div>"+lSd(a,b)+"</div>")}function mSd(a,b,c){b=c||b;return P("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+Q(a.LZ)+"'></div>"+lSd(a,b)+"</div>")}
function nSd(a,b,c){b=c||b;return P("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+Q(a.LZ)+"'><div style='display: table-row;'><div class='nfd-inner-input' style='display: table-cell;'>"+kSd(a)+"</div><div class='nfd-inner-input-content' style='display: table-cell;'><div id='"+Q(a.sGb)+"'></div></div></div></div>"+lSd(a,b)+"</div>")}
function oSd(){var a="<div class='cnf-sample-wrapper'><table class='cnf-sample-table'><tbody>"+pSd({label:""});a+=pSd({label:Sq("Negative:")});a+=pSd({label:Sq("Zero:")});a+=pSd({label:Sq("Text:")});return P(a+"</tbody></table><a class='cnf-help-link' href='//support.google.com/drive/?p=drive_custom_numbers' target='_blank'>Help</a></div>")}function pSd(a){return P("<tr><td class='nfd-sample-label'>"+O(a.label)+"</td><td class='nfd-rendered-sample'></td></tr>")}
function lSd(a,b){a=""+O(br({id:a.RV,style:2,Fd:"nfd-apply",content:Rq("Apply")},b));return P(a)}function kSd(a){return P(O(kRd({id:a.YJa,s$:a.ZJa,eWb:!0})))};function U2(a,b,c,d,e){Nk.call(this,b,c,d,e);this.C=a}x(U2,Nk);U2.prototype.Pj=function(){var a=U2.oa.Pj.call(this),b=this.getParent();return b&&b instanceof Hk&&!b.isVisible()?this.C(a,this.Ta()):a};function qSd(a){T2.call(this,a);this.F=new M;this.C=new dM("")}x(qSd,T2);p=qSd.prototype;p.Ca=function(){var a=N(nSd,{LZ:Ni(this,"nfd-icwr"),YJa:Ni(this,"nfd-i"),ZJa:this.$,sGb:Ni(this,"nfd-ic"),RV:Ni(this,"nfd-a")});this.Hb(a)};p.Ia=function(){qSd.oa.Ia.call(this);var a=Pi(this,"nfd-ic");this.F.gb(a);this.F.Nd(this.J);this.F.Ga(this.C,!0);this.getHandler().R(this.C,"aftershow",this.XYb).R(this.C,"action",this.UGa).R(this.V,"input",Ca(this.oTa,null))};
p.sM=function(a){qSd.oa.sM.call(this,a);a.C&&this.D.Qa(Os[a.C][1]);this.oTa(a)};
p.oTa=function(a){a=a?a.C:void 0;var b=this.C;b.Gf(null);if(a){var c=this.Ta(),d=c.C;rSd(this,c);c=kkc(d,Os[d][2]);c=new $O(sSd(c),jkc[d],d);rSd(this,c);c=kkc(d,d+" "+Os[d][1]);d=new $O(sSd(c),jkc[d],d);rSd(this,d)}else this.Ta().C=null;var e="[$"+this.getValue()+"]";d=a?jkc[a]:null;c=[];c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,0,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!1));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,
0,!1));for(e=0;e<c.length;e++){var f=new $O(sSd(c[e]),d,a);rSd(this,f)}b.Te(0);this.UGa();Nh(b.yc().getElement(),"number-format-menu")};function rSd(a,b){var c=new U2(function(a){return eba(a,25)},dfc(b,1E3),b);a.Aa(c);a.Aa(b);c.lp(!0);a=a.C;for(b=0;b<a.Wh();b++)if(a.Ve(b).Pj()==c.Pj())return;a.ud(c)}p.UGa=function(){for(var a=this.C,b=0;b<a.Wh();b++)a.Ve(b).wc(!1);a.xD()};p.XYb=function(){this.C.Qe().wc(!0)};function sSd(a){var b=new ov;V(b,2,a);b.setType(4);return b};function tSd(a){S2.call(this,a);dq(this,"Custom currencies")}x(tSd,S2);p=tSd.prototype;p.bY=n(1000.12);p.oga=function(){return new qSd("Custom currency")};p.b6=function(){var a=this;rhc();for(var b=this.F,c=0;c<b.length;c++){var d=b[c],e=d.C;e?d.D=jkc[e]:HPd(d,mkc(d.ll()))}var f=[];kc(Os,function(b,c){b=lkc(c);a.Aa(b);f.push(b)});var h=fMc();vb(f,function(a,b){return h(a.Qy(),b.Qy())});return b.concat(f)};
p.V1=function(){var a=new ov;a.setType(4);V(a,3,1);var b=this.input.C.Qe().getValue().ll();V(a,2,b);return a};p.$Ta=function(){return this.input.Ta().C};function uSd(a){M.call(this);a=Math.abs(a);var b=[];b.push(a);b.push(-1*a);b.push(0);this.C=b}x(uSd,M);uSd.prototype.Ca=function(){var a=N(oSd);this.F=Yd("nfd-sample-label",a);this.D=Nca("nfd-rendered-sample",a);this.Hb(a)};function V2(a,b){T2.call(this,a);this.C=new uSd(b);this.Ec(new $O(""))}x(V2,T2);V2.prototype.Ca=function(){var a=N(jSd,{YJa:Ni(this,"nfd-i"),ZJa:this.$,LZ:Ni(this,"nfd-icwr"),RV:Ni(this,"nfd-a")});this.Hb(a)};V2.prototype.Ia=function(){V2.oa.Ia.call(this);this.Ga(this.C,!0);vSd(this)};V2.prototype.ZTa=function(){vSd(this)};V2.prototype.sM=function(a){V2.oa.sM.call(this,a);vSd(this)};
function vSd(a){var b=a.Ta();if(b){var c=a.C;a=b.ll().split(";").length-1;xe(c.F,0<a?"Positive:":"Sample:");for(var d=0;d<c.C.length;d++){var e=c.D[d],f=dfc(b,c.C[d]),h=ritz_api.RitzModelApi.getColorForFormattedString(String(c.C[d]),b.ll()),k=d<=a;L(ue(e),k);xe(e,f);ci(e,"color",h||"")}d=b.hf()?ritz_api.RitzModelApi.renderStringInNumberFormat("text",b.ll()):"Invalid format";b=ritz_api.RitzModelApi.getColorForFormattedString("text",b.ll());c=c.D[3];L(ue(c),3<=a);xe(c,d);ci(c,"color",b||"")}};function wSd(a){S2.call(this,a);dq(this,"Custom number formats")}x(wSd,S2);wSd.prototype.bY=n(1234.56);wSd.prototype.oga=function(){return new V2("Custom number format",1234.56)};
wSd.prototype.b6=function(){var a=this.F;a.push(new $O("0"));a.push(new $O("0.00"));a.push(new $O("#,##0"));a.push(new $O("#,##0.00"));a.push(new $O("#,##0_);(#,##0)"));a.push(new $O("#,##0_);[Red](#,##0)"));a.push(new $O("#,##0.00_);(#,##0.00)"));a.push(new $O("#,##0.00_);[Red](#,##0.00)"));a.push(new $O("$#,##0_);($#,##0)"));a.push(new $O("$#,##0_);[Red]($#,##0)"));a.push(new $O("$#,##0.00_);($#,##0.00)"));a.push(new $O("$#,##0.00_);[Red]($#,##0.00)"));a.push(new $O("@"));a.push(new $O("0%"));a.push(new $O("0.00%"));
a.push(new $O("0.00E+00"));a.push(new $O("##0.0E+0"));a.push(new $O("# ?/?"));a.push(new $O("# ??/??"));a.push(new $O('_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)'));a.push(new $O('_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)'));a.push(new $O('_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)'));a.push(new $O('_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)'));return a};wSd.prototype.V1=function(){var a=new ov;a.setType(2);V(a,3,1);var b=this.input.getValue();V(a,2,b);return a};function W2(a,b){Wk.call(this,b,new xSd(a))}x(W2,Wk);p=W2.prototype;p.Vf=function(a,b,c){W2.oa.Vf.call(this,a,b,c);a.Mb()&&this.Mb()&&a.getParent()==this&&ySd(this)};p.Ia=function(){W2.oa.Ia.call(this);ySd(this)};p.Tc=function(a){W2.oa.Tc.call(this,a);ySd(this)};p.removeChild=function(a,b){a=W2.oa.removeChild.call(this,a,b);ySd(this);return a};p.Ln=function(a,b){a=W2.oa.Ln.call(this,a,b);ySd(this);return a};
p.tj=function(a){var b;if(!(b=37!=a.keyCode&&39!=a.keyCode)){a:{b=a.keyCode;var c=Kk(this);if(c){b=39==b;this.re()&&(b=!b);c=c.getElement();c=Sa(c.parentNode.childNodes,c);var d=(d=(d=Kk(this))?kda(d.getElement(),zSd):null)?Sa(d.parentNode.childNodes,d):-1;var e=d==this.getNumberOfColumns()-1;if(b||0==d)if(b&&!e)e=d+1;else{b=!1;break a}else e=d-1;e=ASd(this,e);b?b=ASd(this,d)-c+Math.min(c,e-1):(b=-(c+1),e>c&&(b-=e-1-c));this.qaa(this.Iq()+b);b=!0}else b=!1}b=!b}return b?W2.oa.tj.call(this,a):!0};
p.getNumberOfColumns=function(){return this.getElement()?this.getElement().childNodes.length:0};function ASd(a,b){return 0==a.getNumberOfColumns()?0:(a.getElement()?a.getElement().childNodes[b]:null).childNodes.length}
function ySd(a){var b,c=a.Pd(),d=a.$c(),e=nb(Xd("div",zSd,a.getElement())),f=a.getElement();for(b=e.length;b<c.D&&b<d;b++)e[b]=a.qa().Ca("DIV",zSd),f.appendChild(e[b]);f=e.length;c=Array(f);d=[];b=0;for(var h=!1,k=0;k<a.$c();k++)a.Vc(k)instanceof Rk?(d.push(new BSd(b,k,!0)),b=k+1):a.Vc(k)instanceof Mk&&(0==k?h=!0:(a.Vc(k-1),d.push(new BSd(b,k-1,!1)),b=k));k=a.$c();0<d.length&&Ra(d).end!=k-1&&d.push(new BSd(b,k-1,!1));b=h;h=a.$c();if(0==d.length&&b)c[0]=h;else{b=d.length-Math.max(0,d.length-f);b=a.$c()-
b;b=Math.ceil(b/f);if(0==d.length)for(h=0;h<f;h++)c[h]=(h+1)*b-1;else CSd(d,b,f);f=d.length;for(b=0;b<f;b++)c[b]=d[b].end}for(f=d=0;f<a.$c();f++){for(;f>c[d];)++d;b=a.Vc(f);h=b.getElement();h.parentNode!=e[d]&&e[d].appendChild(h);f==c[d]&&b instanceof Rk?L(h,!1):L(h,!0)}for(a=e.length-1;a>d;--a)e[a].parentNode.removeChild(e[a]),e[a]=null}
function CSd(a,b,c){function d(a){return a.end-a.start-(a.lFb?1:0)}c=Math.max(0,a.length-c);for(var e=0;e<a.length-1;e++)a[e].C=d(a[e])+d(a[e+1]);for(e=0;e<c;e++){for(var f=32765,h=-1,k=!1,l=0;l<a.length-1;l++){var m=a[l].C;m<f&&(f=m,h=l);if(m<=b){a[l+1].start=a[l].start;hb(a,l,1);k=!0;break}}k||(a[h+1].start=a[h].start,hb(a,l,1))}}function BSd(a,b,c){this.start=a;this.end=b;this.lFb=c}function xSd(a){Qk.call(this);this.D=a}x(xSd,Qk);var zSd="docs-multi-menu-col";function DSd(a){A.call(this);this.C=a}x(DSd,A);DSd.prototype.create=function(){return new W2(this.C)};function ESd(a,b){T2.call(this,a);this.ma=new M;this.H=new FSd;this.F=new M;a=(new DSd(3)).create();a.Ga(new Mk("Date"),!0);a.Ga(new Nk("Day","DAY_TOKEN"),!0);a.Ga(new Nk("Month","MONTH_TOKEN"),!0);a.Ga(new Nk("Year","YEAR_TOKEN"),!0);a.Ga(new Mk("Time:"),!0);a.Ga(new Nk("Hours","HOURS_TOKEN"),!0);a.Ga(new Nk("Minutes","MINUTES_TOKEN"),!0);a.Ga(new Nk("Seconds","SECONDS_TOKEN"),!0);a.Ga(new Nk("Milliseconds","MILLIS_TOKEN"),!0);a.Ga(new Nk("a.m./p.m.","AM_PM_TOKEN"),!0);a.Ga(new Mk("Duration"),!0);
a.Ga(new Nk("Elapsed hours","ELAPSED_HOURS_TOKEN"),!0);a.Ga(new Nk("Elapsed minutes","ELAPSED_MINUTES_TOKEN"),!0);a.Ga(new Nk("Elapsed seconds","ELAPSED_SECONDS_TOKEN"),!0);this.L=new $Rb(a);this.C=b}x(ESd,T2);p=ESd.prototype;p.Ca=function(){var a=N(mSd,{LZ:Ni(this,"nfd-icwr"),RV:Ni(this,"nfd-a")});this.Hb(a)};
p.Ia=function(){ESd.oa.Ia.call(this);Nh(this.getElement(),"nfd-date-time-input");var a=Pi(this,"nfd-icwr"),b=this.ma;b.gb(a);b.Nd(this);b.Ga(this.L,!0);Nh(this.L.getElement(),"nfd-date-time-menu-button");Nh(this.L.yc().getElement(),"nfd-date-time-menu");Kh(this.L.Pa(),"Add a date or time format");b.Ga(this.H,!0);Oc||Nh(this.H.getElement(),"nfd-date-time-left-most");a=this.F;b.Ga(a,!0);ci(a.getElement(),"display","inline");this.getHandler().R(this,"df",Ca(this.aUa,"left")).R(this,"hf",Ca(this.WHa,
"left")).R(this,"jf",Ca(this.WHa,"right")).R(this,"kf",Ca(this.KIa,"left")).R(this,"lf",Ca(this.KIa,"right")).R(this,"gf",Ca(this.aUa,"right")).R(this.L,"action",this.qnb)};p.kCa=function(){this.ma.getElement().focus()};
p.sM=function(a){this.Ec(a.clone());var b=this.F;b.Bd(!0);xe(this.H.getElement(),"");a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a.ll());for(var c=0;c<a.length;c++){var d=a[c],e=d[0];"LITERAL_TOKEN"==e?0==c?xe(this.H.getElement(),d[2]):(e=b.Vc(b.$c()-1),d=d[2],xe(e.Nz.getElement(),Be(e.Nz.getElement())+d)):GSd(this,e).Qa(d[1])}0<b.$c()&&b.Vc(b.$c()-1).Rx.getElement().focus()};
p.getValue=function(){for(var a=this.H.toString(),b=0;b<this.F.$c();b++)a+=this.F.Vc(b).toString();a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a);b="";for(var c=!1,d=0;d<a.length;d++){var e=a[d][1];switch(a[d][0]){case "ELAPSED_HOURS_TOKEN":case "ELAPSED_MINUTES_TOKEN":case "ELAPSED_SECONDS_TOKEN":c?(e=Vb(e,"["),e=Vb(e,"]")):c=!0}b+=e}return b};p.qnb=function(a){a=a.target.getValue();GSd(this,a).Rx.getElement().focus()};
function GSd(a,b){iSd(a,!1);switch(b){case "DAY_TOKEN":var c=HSd(a);break;case "MONTH_TOKEN":c=ISd(a);break;case "YEAR_TOKEN":c=JSd(a);break;case "HOURS_TOKEN":c=KSd();break;case "MINUTES_TOKEN":c=LSd();break;case "SECONDS_TOKEN":c=MSd();break;case "MILLIS_TOKEN":c=NSd();break;case "AM_PM_TOKEN":c=OSd(a);break;case "ELAPSED_HOURS_TOKEN":c=PSd();break;case "ELAPSED_MINUTES_TOKEN":c=QSd();break;case "ELAPSED_SECONDS_TOKEN":c=RSd()}b=c;b.Ga(new Rk,!0);b.Ga(new Nk("Delete"),!0);c=new SSd(c,"");a.F.Ga(c,
!0);return c}p.aUa=function(a,b){b=b.target;if(b instanceof FSd){if(b===this.H&&"left"==a)return;b=b.getParent();if("right"==a&&(b=this.F.Vc(Qi(this.F,b)+1),!b))return}a=Be(b.Nz.getElement());var c=b.getParent(),d=Qi(c,b);c.removeChild(b,!0);0==d?(b=this.H.getElement(),c=Be(b),xe(b,c+a),TSd(this.H,c.length)):(d--,b=c.Vc(d),c=Be(b.Nz.getElement()),xe(b.Nz.getElement(),Be(b.Nz.getElement())+a),TSd(b.Nz,c.length))};
p.KIa=function(a,b){b=b.target.getParent();a="left"==a?0:1;(a=this.F.Vc(Qi(this.F,b)+a))&&a.Rx.getElement().focus()};p.WHa=function(a,b){var c="left"==a?-1:0;(b=this.F.Vc(Qi(this.F,b.target)+c))||"left"!=a?b&&(b=b.Nz):b=this.H;c=Be(b.getElement()).length;TSd(b,"left"==a?c:0)};function SSd(a,b){M.call(this);this.Rx=new dM("",a);this.Ga(this.Rx,!0);this.Nz=new FSd(b);this.Ga(this.Nz,!0)}x(SSd,M);p=SSd.prototype;
p.Ia=function(){SSd.oa.Ia.call(this);ci(this.getElement(),"display","inline-block");this.Rx.Te(0);this.C=new pk(this.Rx.getElement());this.Aa(this.C);this.getHandler().R(this.Rx,"action",this.YYb).R(this.C,"key",this.ZYb)};p.YYb=function(){this.Rx.xD();this.Rx.Qe().Ta()||this.dispatchEvent("gf")};p.ZYb=function(a){switch(a.keyCode){case 8:case 46:a.repeat||(a.preventDefault(),this.dispatchEvent("gf"));break;case 37:a.preventDefault();this.dispatchEvent("hf");break;case 39:a.preventDefault(),this.dispatchEvent("jf")}};
p.toString=function(){return this.Rx.Qe().Ta()+this.Nz.toString()};p.Qa=function(a){this.Rx.Qa(a)};function FSd(a){M.call(this);this.C=a||""}x(FSd,M);p=FSd.prototype;p.Ca=function(){var a=ce("SPAN");Zd(a,{contentEditable:!0});xe(a,this.C);var b=a.style;Lc&&!Vc("8")?(b.whiteSpace="pre",b.wordWrap="break-word"):b.whiteSpace=Oc?"-moz-pre-wrap":"pre-wrap";this.Hb(a)};
p.Ia=function(){FSd.oa.Ia.call(this);var a=new pk(this.getElement());this.Aa(a);this.getHandler().R(a,"key",this.$Yb).R(this.getElement(),"paste",this.aZb)};function TSd(a,b){if(0==Be(a.getElement()).length&&0==b)a.getElement().focus();else{var c=a.getElement().firstChild;b=wK(c,b);a.getElement().focus();b.select()}}
p.$Yb=function(a){var b=Ae(this.getElement()),c=mK(),d=Be(this.getElement()).length,e=c?0==c.uh()&&0==c.xn():Kb(Zb(b));b=c?c.uh()==d&&c.xn()==d:Kb(Zb(b));switch(a.keyCode){case 8:e&&(a.preventDefault(),this.dispatchEvent("df"));break;case 46:b&&(a.preventDefault(),this.dispatchEvent("gf"));break;case 40:this.dispatchEvent("ef");break;case 38:this.dispatchEvent("ff");break;case 37:e&&(a.preventDefault(),this.dispatchEvent("kf"));break;case 39:b&&(a.preventDefault(),this.dispatchEvent("lf"));break;
case 13:a.preventDefault()}};p.toString=function(){var a=Nb(Be(this.getElement())).replace(/"/g,'"\\""');return 0==Zb(a).length?"":'"'+a+'"'};p.aZb=function(){var a=v(function(){xe(this.getElement(),Be(this.getElement()))},this);Zi(a)};
function HSd(a){function b(a){return"Day ("+(a+")")}var c=[],d="d",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Day without leading zero ("+(e+")");c.push(new U2(Ca(b,e),f,d));d="dd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Day with leading zero ("+(e+")");c.push(new U2(Ca(b,e),f,d));d="ddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Day as abbreviation ("+(e+")");c.push(new U2(Ca(b,e),f,d));d="dddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Day as full name ("+
(e+")");c.push(new U2(Ca(b,e),a,d));d=new Wk;for(e=0;e<c.length;e++)d.Ga(c[e],!0);return d}
function ISd(a){function b(a){return"Month ("+(a+")")}var c=[],d="m",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Month without leading zero ("+(e+")");c.push(new U2(Ca(b,e),f,d));d="mm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Month with leading zero ("+(e+")");c.push(new U2(Ca(b,e),f,d));d="mmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Month as abbreviation ("+(e+")");c.push(new U2(Ca(b,e),f,d));d="mmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,
d);f="Month as full name ("+(e+")");c.push(new U2(Ca(b,e),f,d));d="mmmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="First letter of the month ("+(e+")");c.push(new U2(Ca(b,e),a,d));d=new Wk;for(e=0;e<c.length;e++)d.Ga(c[e],!0);return d}
function JSd(a){function b(a){return"Year ("+(a+")")}var c=[],d="yy",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Two-digit year ("+(e+")");c.push(new U2(Ca(b,e),f,d));d="yyyy";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Full numeric year ("+(e+")");c.push(new U2(Ca(b,e),a,d));d=new Wk;for(e=0;e<c.length;e++)d.Ga(c[e],!0);return d}
function KSd(){function a(a){return"Hour ("+(a+")")}var b=[],c="h",d="1",e="Hour without leading zero ("+(d+")");b.push(new U2(Ca(a,d),e,c));c="hh";d="01";e="Hour with leading zero ("+(d+")");b.push(new U2(Ca(a,d),e,c));c=new Wk;for(d=0;d<b.length;d++)c.Ga(b[d],!0);return c}
function LSd(){function a(a){return"Minute ("+(a+")")}var b=[],c="m",d="1",e="Minute without leading zero ("+(d+")");b.push(new U2(Ca(a,d),e,c));c="mm";d="01";e="Minute with leading zero ("+(d+")");b.push(new U2(Ca(a,d),e,c));c=new Wk;for(d=0;d<b.length;d++)c.Ga(b[d],!0);return c}
function MSd(){function a(a){return"Second ("+(a+")")}var b=[],c="s",d="1",e="Second without leading zero ("+(d+")");b.push(new U2(Ca(a,d),e,c));c="ss";d="01";e="Second with leading zero ("+(d+")");b.push(new U2(Ca(a,d),e,c));c=new Wk;for(d=0;d<b.length;d++)c.Ga(b[d],!0);return c}
function NSd(){function a(a){return"Milliseconds ("+(a+")")}var b=[],c="0",d="1",e="Precision to 1/10 of a second ("+(d+")");b.push(new U2(Ca(a,d),e,c));c="00";d="01";e="Precision to 1/100 of a second ("+(d+")");b.push(new U2(Ca(a,d),e,c));c="000";d="001";e="Precision to 1/1000 of a second ("+(d+")");b.push(new U2(Ca(a,d),e,c));c=new Wk;for(d=0;d<b.length;d++)c.Ga(b[d],!0);return c}
function OSd(a){function b(a){return"a.m./p.m. ("+(a+")")}var c=[],d="am/pm",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Full ("+(e+")");c.push(new U2(Ca(b,e),f,d));d="a/p";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Shortened lowercase ("+(e+")");c.push(new U2(Ca(b,e),f,d));d="A/P";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Shortened uppercase ("+(e+")");c.push(new U2(Ca(b,e),a,d));d=new Wk;for(e=0;e<c.length;e++)d.Ga(c[e],!0);return d}
function PSd(){function a(a){return"Elapsed hours ("+(a+")")}var b=[],c="[h]",d="1",e="Elapsed hours without leading zero ("+(d+")");b.push(new U2(Ca(a,d),e,c));c="[hh]";d="01";e="Elapsed hours with leading zero ("+(d+")");b.push(new U2(Ca(a,d),e,c));c=new Wk;for(d=0;d<b.length;d++)c.Ga(b[d],!0);return c}
function QSd(){function a(a){return"Elapsed minutes ("+(a+")")}var b=[],c="[m]",d="1",e="Elapsed minutes without leading zero ("+(d+")");b.push(new U2(Ca(a,d),e,c));c="[mm]";d="01";e="Elapsed minutes with leading zero ("+(d+")");b.push(new U2(Ca(a,d),e,c));c=new Wk;for(d=0;d<b.length;d++)c.Ga(b[d],!0);return c}
function RSd(){function a(a){return"Elapsed seconds ("+(a+")")}var b=[],c="[s]",d="1",e="Elapsed seconds without leading zero ("+(d+")");b.push(new U2(Ca(a,d),e,c));c="[ss]";d="01";e="Elapsed seconds with leading zero ("+(d+")");b.push(new U2(Ca(a,d),e,c));c=new Wk;for(d=0;d<b.length;d++)c.Ga(b[d],!0);return c};function USd(a){S2.call(this,a);dq(this,"Custom date and time formats")}x(USd,S2);p=USd.prototype;p.ARa=Oe;p.bY=n(11175.5628472222);p.isEmpty=function(){return Kb(gv(this.V1(),2))};p.hf=function(){return ritz_api.RitzModelApi.isValidFormatPattern(gv(this.V1(),2))};p.oga=function(){return new ESd("Custom date time format",11175.5628472222)};p.V1=function(){return VSd(this.input.getValue())};
p.b6=function(){for(var a=this.F,b=0;b<a.length;b++){var c=a[b],d=ritz_api.RitzModelApi.renderFormattedString(this.bY(),c.ll());c.D=d}b=WSd(this);rb(b);for(c=0;c<b.length;c++)a.push(new $O(VSd(b[c]),ritz_api.RitzModelApi.renderFormattedString(this.bY(),b[c])));return a};
function WSd(a){var b=Es,c=Va(b.DATEFORMATS,function(a){return XSd(a)},a),d=Va(b.TIMEFORMATS,function(a){return XSd(a)},a),e=c.concat(d);b=b.DATETIMEFORMATS;rb(b);a=Va(b,function(a){return XSd(a)},a);for(b=0;b<a.length;b++){var f=a[b];f=f.replace(/\{1\}/,c[0]);f=f.replace(/\{0\}/,d[0]);e.push(f)}return e}
function XSd(a){a=a.split(/('+)/);for(var b=!1,c=0;c<a.length;++c){var d=a[c].match(/'/g);if(d){for(var e="",f=0;f<a[c].length;f+=2)e+="'";a[c]=e}d&&1==d.length%2?(a[c]='"',b=!b):d||b||(d=a[c],d=d.replace(/E/gi,"d"),d=d.replace(/z/gi,""),d=d.replace(/a/gi,"am/pm"),d=d.replace(/\[/gi,""),d=d.replace(/\]/gi,""),d=d.replace(/\by\b/gi,"yyyy"),a[c]=d)}return Ob(a.join(""))}function VSd(a){var b=new ov;b.setType(7);V(b,3,1);V(b,2,a);return b};function YSd(a,b){this.D=a;this.C=b}YSd.prototype.getUrl=g("D");YSd.prototype.getTitle=g("C");function ZSd(a,b,c,d,e,f){Mr.call(this,a,b,"domain",d,e,f);this.H=c}x(ZSd,Mr);ZSd.prototype.AV=function(){var a=ZSd.oa.AV.call(this);a.domainName=this.H;return lc(a,BFa)};UFa.set("domain",function(a){return new ZSd(a.name,a.id,a.domainName,a.me,a.iconUrl,a.requiresKey)});new ZSd("","DEFAULT","",!0);function $Sd(){};function aTd(a){for(var b="",c=a.uSb,d=c.length,e=0;e<d;e++){var f=c[e],h=a.sSb[f.vh()],k=f.getLabel();f=f.aGb;f=P('<div id="'+Q(h)+'" tabindex="0" role="link" class="'+Q("ess-button")+'" aria-label="'+Q(k)+'"><div class="'+Q("ess-icon")+" "+Q(f)+'"></div></div>');b+=f}return P(b)};function bTd(a,b){M.call(this,b);this.D=a||[];this.F=[];this.C=null}x(bTd,M);p=bTd.prototype;p.Sd=!0;p.Eea=!1;p.rP=null;p.yAa=!1;p.Oa=function(a,b){this.Sd=a;this.Eea=b;if(this.yAa){b=this.qa();for(var c=0,d;d=this.D[c];c++){var e=b.getElement(this.rP.zqa+"-"+d.vh()),f=a;Rh(e,"ess-button",f);Rh(e,"ess-disabled-button",!f);f=d.getName();d=d.getLabel();sj(e,f,d)}}};
p.Ca=function(){this.Hb(this.rb.createElement("SPAN"));var a={};a.zqa=Ni(this,"service");a.uSb=this.D;this.rP=a;for(var b={},c=0,d;d=this.D[c];c++)b[d.vh()]=this.rP.zqa+"-"+d.vh();a.sSb=b;this.rP=a;Fq(this.getElement(),aTd,this.rP);this.yAa=!0};
p.mQb=function(a){if(this.Sd){if(this.C){var b={};b.externalSharingService=a.C;this.C.C(9,b)}if(this.Eea)this.dispatchEvent(new cTd(new dTd(a,this.F,this.C||void 0)));else{var c=this.C||void 0;b=a.getUrl(this.F);if(c){var d={};d.externalSharingService=a.C;c.C(10,d)}a={ZIc:!0};a.target=a.target||b.target||"google_popup";a.width=a.width||690;a.height=a.height||500;(a=op(b,a))&&a.focus()}}};
p.Ia=function(){this.Oa(this.Sd,this.Eea);for(var a=this.qa(),b=this.getHandler(),c=0,d;d=this.D[c];c++){var e=a.getElement(this.rP.zqa+"-"+d.vh());b.jg(e,of,v(this.mQb,this,d))}};p.Ha=function(){bTd.oa.Ha.call(this);delete this.F;delete this.D;this.C=null};function cTd(a,b){D.call(this,"mf",b);this.context=a}x(cTd,D);function dTd(){}x(dTd,$Sd);function X2(a,b,c,d){this.C=a;this.F=b;this.D=c;this.aGb=d;this.H=eTd++}var eTd=0;X2.prototype.vh=g("H");X2.prototype.getName=g("F");X2.prototype.getLabel=g("D");function fTd(){X2.call(this,"fb","Facebook","Share via Facebook","ess-facebook-icon")}x(fTd,X2);fTd.prototype.getUrl=function(a){var b=Va(a,function(a){return a.getTitle()});a=Va(a,function(a){return a.getUrl()});return"http://www.facebook.com/share.php?u="+Pb(a.join(","))+"&t="+Pb(b.join(","))};function gTd(){X2.call(this,"gp","Google+","Share via Google+","ess-gplus-icon")}x(gTd,X2);gTd.prototype.getUrl=function(a){return 0==a.length?"http://plus.google.com":"http://plus.google.com/share?url="+Pb(a[0].getUrl())};function hTd(){X2.call(this,"gm","Gmail","Share via Gmail","ess-gmail-icon")}x(hTd,X2);hTd.prototype.getUrl=function(a){a=Va(a,function(a){return a.getTitle()+" - "+a.getUrl()});return"https://mail.google.com/mail/?view=cm&ui=2&cmid=0&fs=1&tf=1&body="+Pb(a.join("\n"))};function iTd(){X2.call(this,"tw","Twitter","Share via Twitter","ess-twitter-icon")}x(iTd,X2);iTd.prototype.getUrl=function(a){for(var b=oa(void 0)?void 0:140,c=[],d=0,e=0;e<a.length;e++){var f=a[e].getUrl(),h=d+f.length+(d?1:0);if(h>b)break;else c.push(f),d=h}for(e=0;e<a.length;e++){f=a[e].getTitle();h=c[e]?" - ":"";var k=b-d-h.length;if(k<f.length)if(4<=k)f=f.substring(0,k-3)+"\u2026";else break;d+=f.length+h.length;c[e]=f+h+(c[e]?c[e]:"")}a=c.join(" ");return"http://twitter.com/home?status="+Pb(a)};function Y2(a){M.call(this,a)}x(Y2,M);function jTd(a){a.dispatchEvent(new D("nf"))}Y2.prototype.eY=function(){return{}};Y2.prototype.mK=Qe;Y2.prototype.tqa=sa;function kTd(a){M.call(this,a)}x(kTd,M);kTd.prototype.F=Qe;kTd.prototype.H=sa;kTd.prototype.J=sa;function lTd(a,b,c){b=c||b;c='<div class="pub-dialog-wrap"><div><div class="pub-dialog-info" aria-live="polite" id="pub-dialog-status-info"></div><div class="pub-dialog-option-vspacer"></div><div class="pub-dialog-info-help">';var d="Make your content visible to anyone by publishing it to the web. You can link to or embed your document. "+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+NPd(a.locale)+'&answer=183965">Learn more</a>');c=c+d+'</div><div id="pub-dialog-links-tab-bar" class="pub-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="pub-dialog-link-tab" class="pub-dialog-tab goog-tab goog-tab-selected">Link';
c+='</div><div id="pub-dialog-embed-tab" class="pub-dialog-tab goog-tab">';c+="Embed";c+='</div></div><div class="goog-tab-bar-clear"></div><div class="goog-tab-content"><div id="pub-dialog-link-tab-content"><div id="pub-dialog-link-options"></div><input id="pub-dialog-document-link" type="text" class="pub-dialog-document-link jfk-textinput" value="'+Q(a.I8a)+'" readonly="readonly" aria-label="';c+=Vq("Link to published document.");c+=" "+Q(a.$Oa)+'"><div id="pub-dialog-sharing-services" class="pub-dialog-link-content-div"><label for="pub-dialog-sharing-services-links">';
c+="Or share this link using:";c+='</label><span id="pub-dialog-sharing-services-links"></span></div></div><div id="pub-dialog-embed-tab-content" style="display:none"><div id="pub-dialog-embed-options"></div><textarea id="pub-dialog-embed-code" rows="3" cols="60" class="pub-dialog-embed-code jfk-textinput" readonly="readonly" aria-label="';c+=Vq("HTML embed code of published document.");c+=" "+Q(a.$Oa)+'">'+NDa(a.Acb)+'</textarea></div></div><div id="pub-dialog-links-notice"></div>'+O(br({id:"pub-dialog-publish-link-button",
style:2,value:a.lQb},b))+'<div class="pub-dialog-sep-div"><hr class="pub-dialog-sep"></div><div class="pub-dialog-settings"><div id="pub-dialog-settings-header" class="pub-dialog-zippy-header">'+O(Sr({wt:"pub-dialog-settings-zippy-icon",icon:"docs-icon-img docs-zippy-closed"},b));c+="Published content and settings";c+='</div><div id="pub-dialog-settings-content" class="pub-dialog-zippy-content"><div id="pub-dialog-published-content"></div>'+O(br({id:"pub-dialog-publish-button",value:a.jQb},b))+'<div class="pub-dialog-checkbox-container">';
a.EGb&&(c+=O(it({id:"pub-dialog-dom-signin-req",checked:a.Os,disabled:a.HJ},b))+' <label for="pub-dialog-dom-signin-req" id="pub-dialog-dom-signin-req-label"'+(a.HJ?' class="pub-dialog-disabled-text"':"")+">",d="Require viewers to sign in with their "+(O(a.domain)+" account"),c+=d,c+="</label><br>");a.xP&&(c+=O(it({id:"pub-dialog-auto-publish-checkbox"},b))+' <label for="pub-dialog-auto-publish-checkbox" id="pub-dialog-auto-publish-checkbox-label">',c+="Automatically republish when changes are made",
c+="</label>");c+="</div></div></div></div></div>";return P(c)};function Z2(a,b,c,d,e,f,h,k,l,m){et.call(this);this.sb=a||"";this.Ie=b;this.bd=c;this.Sc=d;this.Hc=l||"/publishsettings";this.C=new mTd(e);this.zb=new bTd([new gTd,new hTd,new fTd,new iTd]);this.Ga(this.zb);this.xa=new cr(null,this.qa());this.Ga(this.xa);this.ma=new cr(null,this.qa());this.Ga(this.ma);this.Sa=new jt(void 0,this.qa());this.Ga(this.Sa);this.Da=new jt(void 0,this.qa());this.Ga(this.Da);this.Ua=0;this.Pb=new nTd;this.Ga(this.Pb);this.yb=this.Eb=null;this.J=f||new Y2;this.Ga(this.J);this.F=
h||new Y2;this.Ga(this.F);this.Ra=k||new kTd;this.Ga(this.Ra);this.O=this.L=null;this.Na=new Kr(void 0,oTd,this.qa(),2);this.Aa(this.Na);this.le=this.fd=null;this.Ke=m||new M;this.Tb=this.mb=this.Jb=null;this.Ai=!0}x(Z2,et);var oTd="Press "+((Rc?"\u2318+C":"Ctrl+C")+" to copy.");p=Z2.prototype;p.kd=function(){Z2.oa.kd.call(this);this.Na.kd()};p.show=function(){pTd(this,v(function(){this.setVisible(!0)},this))};
p.setVisible=function(a){Z2.oa.setVisible.call(this,a);var b=Ie(this.qa());a?this.getHandler().R(b,"resize",this.kd):this.getHandler().Gc(b,"resize",this.kd)};
p.Ca=function(){Z2.oa.Ca.call(this);var a=this.qa(),b=N(lTd,{EGb:!!this.C.domain,xP:this.C.xP(),Os:this.C.Os,domain:this.C.C,HJ:this.C.HJ,jQb:qTd(this),lQb:$2(this,rTd(this))?"Published":"Publish",I8a:this.C.Ak?sTd(this,this.J.eY()):"",Acb:this.C.Ak?tTd(this,this.F.eY()):"",locale:"en-GB",$Oa:oTd});a.appendChild(this.Lb(),b);dq(this,"Publish to the web");oq(this,null);Nh(this.Lb(),"pub-dialog-content")};
p.Ia=function(){var a=this.qa(),b=a.getElement("pub-dialog-sharing-services-links");this.zb.render(b);b=a.getElement("pub-dialog-link-options");this.J.render(b);b=a.getElement("pub-dialog-embed-options");this.F.render(b);this.Jb=a.getElement("pub-dialog-links-notice");this.Ke.render(this.Jb);b=a.getElement("pub-dialog-published-content");this.Ra.render(b);Z2.oa.Ia.call(this);b=this.getHandler();var c=a.getElement("pub-dialog-dom-signin-req");c&&(this.Sa.gb(c),ht(this.Sa,a.getElement("pub-dialog-dom-signin-req-label")),
b.R(this.Sa,"change",this.oVb));this.C.xP()&&(this.Da.gb(a.getElement("pub-dialog-auto-publish-checkbox")),ht(this.Da,a.getElement("pub-dialog-auto-publish-checkbox-label")),b.R(this.Da,"change",this.kVb));this.Eb=a.getElement("pub-dialog-link-tab-content");this.L=a.getElement("pub-dialog-document-link");this.yb=a.getElement("pub-dialog-embed-tab-content");this.O=a.getElement("pub-dialog-embed-code");Jr(this.Na,this.L);this.Pb.gb(a.getElement("pub-dialog-links-tab-bar"));this.fd=a.getElement("pub-dialog-sharing-services");
this.le=a.getElement("pub-dialog-status-info");this.xa.gb(a.getElement("pub-dialog-publish-link-button"));this.ma.gb(a.getElement("pub-dialog-publish-button"));this.Tb=new HN("pub-dialog-settings-header","pub-dialog-settings-content",this.C.Ak);this.Aa(this.Tb);b.R(this.Pb,"select",this.pAb).R(this.L,"focus",this.vQa).R(this.O,"focus",this.vQa).R(this.ma,"action",this.nQb).R(this.getElement(),"keyup",this.W7a).R(this.J,"nf",this.esa).R(this.F,"nf",this.esa).R(this.xa,"action",this.pyb).R(this.Ra,
"of",this.qyb).R(this.Tb,"toggle",this.kd);uTd(this)};function uTd(a){if(a.Mb()){var b=a.qa(),c=a.C.Ak,d=a.C.HJ;a.Ra.H(a.C.Em);a.Sa.Oa(!d);a.ma.setContent(qTd(a));a.ma.Oa(a.C.Ak||!a.C.Em||!a.C.Em.isEmpty());a.C.xP()&&a.Da.wc(a.C.cw);a.esa();b=b.ri("pub-dialog-state-publishing");z(b,function(a){L(a,c)});xe(a.le,c?"This document is published to the web.":"This document is not published to the web.");a.kd()}}p.W7a=function(a){this.isVisible()&&27==a.keyCode&&a.stopPropagation()};
function vTd(a,b){var c=window.location.href,d=ml(c);c=pl(c);var e=Tb(c,"/"+a.Sc+"/")?"/"+a.Sc:"";a.C.Os&&a.C.domain&&(e="/a/"+a.C.domain+e);c=d[1];var f=d[2],h=d[3];d=d[4];a=a.C.F||a.sb;b=jKa.test(b)?b:El("/d/"+a,b);return ll(c,f,h,d,El(e,b))}
p.esa=function(){var a=this.J.mK();if(a=$2(this,a)){var b=this.C.Ak?sTd(this,this.J.eY()):"";this.L.value=b;this.zb.F=[new YSd(b,this.Ie)]}L(this.L,a);L(this.fd,a&&!this.C.HJ);a=this.F.mK();if(a=$2(this,a))this.O.value=this.C.Ak?tTd(this,this.F.eY()):"";L(this.O,a);a=$2(this,rTd(this));L(this.Jb,a);this.xa.Oa(!a);this.xa.setContent($2(this,rTd(this))?"Published":"Publish")};
p.pAb=function(a){a=a.target;this.qa();GFa(this.Na);"pub-dialog-link-tab"==a.getId()?(this.Ua=0,L(this.Eb,!0),L(this.yb,!1),Jr(this.Na,this.L)):"pub-dialog-embed-tab"==a.getId()&&(this.Ua=1,L(this.Eb,!1),L(this.yb,!0),Jr(this.Na,this.O));uTd(this)};p.vQa=function(a){Zi(function(){a.target.select()},0)};p.oVb=function(){this.C.Ak?wTd(this,2,!1):this.C.Os=!this.C.Os};p.kVb=function(){this.C.Ak?wTd(this,0,!1):this.C.cw=!this.C.cw};function qTd(a){return a.C.Ak?"Stop publishing":"Start publishing"}
function pTd(a,b){as(Tm(a.bd.$e(a.Hc),"id",a.sb),v(function(a){this.C.Ak=!!du(a,"published");this.C.Os=!!du(a,"requireSignin");this.C.HJ=!!du(a,"domainClosed");this.C.domain=DAc(a,"domain");this.C.C=DAc(a,"domainDisplay");this.C.cw=!Number(du(a,"revision"));this.C.Em=this.ODa(a.Ye());this.C.F=DAc(a,"publishedDocumentId");b()},a)).Ee()}p.ODa=Qe;p.uDa=Qe;function xTd(a){return{cw:a.C.cw,Ak:a.C.Ak,Os:a.C.Os,Em:a.C.Em}}
function wTd(a,b,c){c=t(c)?c:!0;var d=xTd(a);switch(b){case 0:d.cw=!d.cw;break;case 1:d.Ak=!d.Ak;break;case 2:d.Os=!d.Os;break;default:throw Error("Unknown toggle op: "+b);}d.Ak||(d.Em=a.uDa());yTd(a,d,c)}
function yTd(a,b,c){zTd(a,!1);St(as(Sm(lt(Tm(a.bd.$e(a.Hc),"id",a.sb),ATd(a,b)),2),v(function(){this.C.cw=b.cw;this.C.Ak=b.Ak;this.C.Os=b.Os;this.C.Em=b.Em;this.C.Ak&&this.C.Em&&($2(this,this.J.mK())||this.J.tqa(this.C.Em),$2(this,this.F.mK())||this.F.tqa(this.C.Em));zTd(this,!0);uTd(this);if(c&&this.C.Ak)switch(this.Ua){case 0:this.L.focus();this.L.select();break;case 1:this.O.focus();this.O.select();break;default:throw Error("Cannot handle selected link type "+this.Ua);}},a)),v(function(){jLa("An error occurred whilst saving publishing settings.",
void 0,this.Mb()?this:void 0);zTd(this,!0);uTd(this)},a)).Ee()}function ATd(a,b){var c={id:a.sb,requireSignin:b.Os,published:b.Ak};a.C.xP()&&!b.cw&&(c.revision=a.C.D);b.Em&&(a=BTd(b.Em),Ec(c,a));return c}function zTd(a,b){for(var c=[a.Da,a.ma,a.xa,a.Sa],d=0;d<c.length;d++){var e=c[d];!b&&e.Wl()&&(a.mb=e);e.Oa(b)}b&&a.mb&&(a.isVisible()&&a.mb.isVisible()&&(c=a.mb.getElement())&&c.focus(),a.mb=null);a.Ra.J(b)}
p.nQb=function(a,b){if(b||window.confirm(this.C.Ak?"Are you sure you want to stop publishing this document?":"Are you sure you want to publish this document?"))this.ma.setContent("Saving..."),wTd(this,1)};function rTd(a){switch(a.Ua){case 0:return a.J.mK();case 1:return a.F.mK();default:throw Error("Cannot handle selected link type "+a.Ua);}}
p.pyb=function(){if(window.confirm("Are you sure you want to publish this selection?")){var a=rTd(this),b=xTd(this);b.Ak=!0;a&&(b.Em&&this.C.Ak?b.Em=CTd(b.Em,a):b.Em=a);this.xa.setContent("Publishing...");yTd(this,b,!0)}};p.qyb=function(){var a=this.Ra.F();if(this.C.Ak)if(a&&a.isEmpty())wTd(this,1);else{var b=xTd(this);b.Em=a;yTd(this,b)}else this.C.Em=a,uTd(this)};function $2(a,b){var c;(c=a.C.Ak)&&!(c=!b||!a.C.Em)&&(a=a.C.Em,c=a.F||!b.F&&Ya(b.D.qd(),a.R8,a)&&Ya(b.C,a.G8,a));return c}
function mTd(a){this.D=a;this.HJ=this.Os=this.Ak=!1;this.cw=!0;this.F=this.C=this.domain=""}mTd.prototype.xP=function(){return!!this.D};function nTd(){wS.call(this)}x(nTd,wS);nTd.prototype.tj=function(a){return a.keyCode&&27==a.keyCode?!1:nTd.oa.tj.call(this,a)};function DTd(a,b,c,d){this.F=a;this.wh=b;this.C=c;this.D=d}function ETd(a,b){return new DTd(!1,null,new FTd(a,b||"interactive"),null)}function FTd(a,b){this.id=a;this.format=b};function a3(a,b,c){this.F=a;this.D=new PE(b);this.C=c}p=a3.prototype;p.R8=function(a){return this.F||this.D.contains(a)};function GTd(a,b){return Xa(a.C,function(a){return a.id==b.id})}p.G8=function(a){return this.F||this.D.contains(a.wh)||GTd(this,a)};function HTd(a,b){a.C=Ua(a.C,function(a){return a.wh!=b})}function ITd(a,b){GTd(a,b)&&(a.C=Ua(a.C,function(a){return a.id!=b.id}))}
function CTd(a,b){var c=a.F||b.F;if(c)return new a3(c,[],[]);var d=a.clone();z(b.D.qd(),function(a){d.D.contains(a)||(d.D.add(a),HTd(d,a))});z(b.C,function(a){d.G8(a)||d.C.push(a)});return d}function BTd(a){return a.F?{entireDocument:"true"}:{entireDocument:"false",sheets:a.D.qd().join(","),charts:Va(a.C,function(a){return a.id}).join(",")}}p.isEmpty=function(){return!this.F&&this.D.isEmpty()&&cb(this.C)};p.clone=function(){return new a3(this.F,this.D.qd(),nb(this.C))};
p.equals=function(a){return this.F==a.F&&this.D.equals(a.D)&&yb(this.C,a.C,function(a,c){return a.id==c.id&&a.wh==c.wh})};function JTd(a,b){this.id=a;this.wh=b};function KTd(a,b,c,d){M.call(this,void 0);this.C=c||new DTd(!0,null,null,"html");this.J=d;this.O=a;this.L=b;this.D=new dM("",LTd(a,b));QO(this.D,!0);this.Ga(this.D,!0);a=new Wk;a.Ga(new Nk("Interactive","interactive"),!0);a.Ga(new Nk("Image","image"),!0);this.H=new dM("",a);this.Ga(this.H,!0);a=new Wk;a.Ga(new Nk("Web page","html"),!0);a.Ga(new Nk("Comma-separated values (.csv)","csv"),!0);a.Ga(new Nk("Tab-separated values (.tsv)","tsv"),!0);a.Ga(new Nk("PDF document (.pdf)","pdf"),!0);a.Ga(new Nk("Microsoft Excel (.xlsx)",
"xlsx"),!0);a.Ga(new Nk("OpenDocument spreadsheet (.ods)","ods"),!0);this.F=new dM("",a);this.Ga(this.F,!0);MTd(this)}x(KTd,Y2);var NTd=["xlsx","ods"],OTd=["csv","tsv"];
function LTd(a,b){var c=new Wk;c.Ga(new Nk("Entire Document",new PTd("entireDocument",null)),!0);c.Ga(new Rk,!0);var d=aub(b);z(a.D,function(a){c.Ga(new Nk(a.$d(),new PTd("sheet",a.Db())),!0);if(a=d[a.Db()])for(var b={},e=0;e<a.length;b={$V:b.$V},e++){var k=a[e];6==k.getType()&&k.isSaved()&&(b.$V=new Nk("",new PTd("chart",CH(k))),MH(k).then(function(a){return function(b){a.$V.Fm(b.getTitle())}}(b)),c.Ga(b.$V,!0),Nh(b.$V.Lb(),"pub-dialog-link-options-chart-menu-item"))}});return c}p=KTd.prototype;
p.Ia=function(){KTd.oa.Ia.call(this);Nh(this.getElement(),"pub-dialog-link-options-container");Nh(this.D.getElement(),"pub-dialog-link-options-document-part-menu-button");Nh(this.D.Lb(),"pub-dialog-link-options-document-part-menu-button-content");Nh(this.D.yc().getElement(),"pub-dialog-link-options-document-part-menu");Kh(this.D.Pa(),"Sheet or chart selection");Kh(this.H.Pa(),"Chart format");Kh(this.F.Pa(),"Sheet format");this.getHandler().R(this.D,"change",this.oob).R(this.H,"change",this.hlb).R(this.F,
"change",this.ZAb).R(this.D,"afterhide",function(a){a.stopPropagation()}).R(this.H,"afterhide",function(a){a.stopPropagation()}).R(this.F,"afterhide",function(a){a.stopPropagation()})};p.oob=function(){var a=this.D.Qe().Ta();switch(a.type){case "entireDocument":this.C=new DTd(!0,null,null,this.C.D||"html");break;case "sheet":a=a.id+"";var b=this.C.D;b&&!QTd(this,a,b)&&(b=null);this.C=new DTd(!1,a,null,b||"html");break;case "chart":this.C=ETd(a.id,this.C.C?this.C.C.format:null)}MTd(this);jTd(this)};
p.hlb=function(){var a=this.H.Qe().Ta();this.C.C&&(this.C.C.format=a,jTd(this))};p.ZAb=function(){var a=this.F.Qe().Ta();this.C.D=a;jTd(this)};
function MTd(a){var b=nb(a.D.ij.C);b=Za(b,function(a){a=a.Ta();if(!a)return!1;switch(a.type){case "entireDocument":return this.C.F;case "sheet":return null!=this.C.wh&&a.id==this.C.wh;case "chart":return null!=this.C.C&&a.id==this.C.C.id;default:return!1}},a);rr(a.D,b);b=!!a.C.C;L(a.H.getElement(),b);null!=a.C.C&&a.H.Qa(a.C.C.format);L(a.F.getElement(),a.J&&!b);b||(RTd(a),a.F.Qa(a.C.D))}
function RTd(a){for(var b=a.F.yc(),c=0;c<b.Wh();c++){var d=b.Ve(c),e=d.getValue();d.Oa(null==a.C.wh||QTd(a,a.C.wh,e))}}function QTd(a,b,c){if(bb(NTd,c))return!1;a=VF(a.O,b);return null!=a&&1==a.getSheetType()&&bb(OTd,c)?!1:!0}p.eY=g("C");p.mK=function(){if(this.C.F)return new a3(!0,[],[]);if(null!=this.C.wh)return new a3(!1,[this.C.wh],[]);var a=this.L.C(this.C.C.id);a=new JTd(this.C.C.id,a.Db());return new a3(!1,[],[a])};
p.tqa=function(a){if(!a.F){var b=a.D.qd();0<b.length?this.C=new DTd(!1,b[0],null,"html"):(a=a.C,0<a.length&&(this.C=ETd(a[0].id)));MTd(this)}};function PTd(a,b){this.type=a;this.id=b};function b3(a,b){gr.call(this,void 0,void 0,new bM,void 0);this.Da=a;this.ma=b;this.F=new a3(!0,[],[]);this.V=!1;this.H=new FN("Entire Document");this.ud(this.H);this.ud(new Rk);STd(this);QO(this,!0);TTd(this)}x(b3,gr);function STd(a){var b=aub(a.ma);z(a.Da.D,function(c){var d=new FN(c.$d(),c);a.ud(d);(c=b[c.Db()])&&z(c,function(b){if(6==b.getType()&&b.isSaved()){var c=new FN("",b);MH(b).then(function(a){c.Fm(a.getTitle())});a.ud(c);Nh(c.Lb(),"pub-dialog-published-content-chart-menu-item")}})})}
b3.prototype.Ia=function(){b3.oa.Ia.call(this);Nh(this.getElement(),"pub-dialog-published-content-menu-button");Nh(this.Lb(),"pub-dialog-published-content-menu-button-content");Nh(this.yc().getElement(),"pub-dialog-published-content-menu");this.getHandler().R(this,"afterhide",function(a){a.stopPropagation()})};
b3.prototype.vs=function(a){if(a.target==this.H){a=this.H.isChecked();var b=this.F;if(b.F=a)b.D.clear(),b.C=[]}else b=a.target,a=b.isChecked(),b=b.Ta(),b instanceof UF?(b=b.Db(),a?(a=this.F,a.D.contains(b)||(a.D.add(b),HTd(a,b))):(a=this.F,a.D.contains(b)&&(a.D.remove(b),HTd(a,b)))):(b=new JTd(CH(b),b.Db()),a?(a=this.F,a.G8(b)||a.C.push(b)):ITd(this.F,b));this.V=!0;TTd(this)};b3.prototype.Md=function(a,b){b3.oa.Md.call(this,a,b);!a&&this.V&&(this.V=!1,this.dispatchEvent(new D("of")))};
function TTd(a){var b=a.F.F;a.H.wc(b);z(AAc(a.yc()),function(c){var d=c.Ta();d&&(d instanceof UF?(c.wc(a.F.R8(d.Db())),c.Oa(!b)):(d=new JTd(CH(d),d.Db()),c.wc(a.F.G8(d)),c.Oa(!a.F.R8(d.wh))))});UTd(a)}
function UTd(a){if(a.F.F)a.setContent("Entire Document");else{var b=Ua(a.Da.D,v(function(a){return this.F.R8(a.Db())},a)),c=Va(b,function(a){return a.$d()});b=[];for(var d=a.F.C,e=0;e<d.length;e++){var f=a.ma.C(d[e].id);f&&b.push(MH(f))}Sea(b).then(function(b){for(var d=[],e=0;e<b.length;e++){var f=b[e];f.wCa&&d.push(f.value.getTitle())}b=mb(c,d);b=0<b.length?b.join(", "):"None";a.setContent(b)})}};function c3(a,b){M.call(this,void 0);this.C=new b3(a,b);this.Ga(this.C,!0);this.D=!1}x(c3,kTd);c3.prototype.Ia=function(){c3.oa.Ia.call(this);Nh(this.getElement(),"pub-dialog-published-content-container")};c3.prototype.F=function(){return this.C.F};c3.prototype.H=function(a){var b=this.C;b.F=a.clone();TTd(b)};c3.prototype.J=function(a){!a&&this.C.Wl()&&(this.D=!0);this.C.Oa(a);a&&this.D&&(this.Mb()&&(a=this.C.getElement())&&a.focus(),this.D=!1)};function VTd(a){var b='<div class="pub-dialog-chart-notice">';a='<span class="pub-dialog-chart-notice-emphasis">Note:</span> Viewers may be able to access the underlying data for published charts. '+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+NPd(a.locale)+'&answer=183965#publishcharts">Learn more</a>');return P(b+a+"</div>")};function WTd(a,b,c,d,e,f,h){var k=null!=h?ETd(h):null;h=new KTd(c,d,k,!0);k=new KTd(c,d,k,!1);Z2.call(this,a,b,e,i4a,f,h,k,new c3(c,d),"/publishingsettings",new XTd);this.jf=c;this.hc=d}x(WTd,Z2);
WTd.prototype.ODa=function(a){if(a.entireDocument)return new a3(!0,[],[]);var b=a.charts||"";a=Ua((a.sheets||"").split(","),function(a){return null!=VF(this.jf,a)},this);b=Va(b.split(","),function(a){return parseInt(a,10)});b=Ua(b,v(function(a){return!!this.hc.C(a)},this));b=Va(b,function(a){var b=this.hc.C(a);return new JTd(a,b.Db())},this);return new a3(!1,a,b)};WTd.prototype.uDa=function(){return new a3(!0,[],[])};
function sTd(a,b){if(b.F||null!=b.wh){var c="html"==b.D;a=vTd(a,c?"/pubhtml":"/pub");null!=b.wh&&(a=xl(a,"gid",b.wh,"single","true"));c||(a=xl(a,"output",b.D))}else a=xl(vTd(a,"/pubchart"),"oid",b.C.id,"format",b.C.format);return a}
function tTd(a,b){var c=sTd(a,b);if(b.F||null!=b.wh)c=xl(c,"widget","true","headers","false");a=b.C?(a=a.hc.C(b.C.id))?a.Xc():null:null;return"<iframe "+(a?'width="'+a.width+'" height="'+a.height+'" seamless frameborder="0" scrolling="no" ':"")+'src="'+Rb(c)+'"></iframe>'}function XTd(){}x(XTd,M);XTd.prototype.Ca=function(){this.Hb(N(VTd,{locale:"en-GB"}))};function YTd(){A.call(this)}x(YTd,Hz);p=YTd.prototype;p.Idb=function(){return dSd};p.aeb=function(){return vRd};p.CKb=function(a,b,c,d){var e=new Rr;a=new uq(a,b,c,d,void 0,!0,void 0);zq(a,"ok");b=v(e.gb,e);a.Ima=b;a.Aa(e);a.Ai=!0;a.T6=yda(Kb);return a};p.Jfb=function(){return oRd};p.h5a=function(a,b,c,d,e,f,h){return new YRd(a,b,c,d,e,f,h,void 0)};p.meb=function(){return xQd};p.kDa=function(){return NQd};p.Ceb=function(){return XQd};p.Ofb=function(){return R2};p.Nfb=function(){return WTd};
p.ufb=function(){return eRd};p.Mfb=function(){return yRd};p.feb=function(){return wSd};p.Kfb=function(){return tSd};p.Lfb=function(){return USd};p.eeb=function(){return G2};p.veb=function(){return QPd};p.tgb=function(){return RPd};Vz("dialogs",YTd);
